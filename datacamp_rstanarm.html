<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DataCamp: Bayesian Regression Modeling with rstanarm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="datacamp_rstanarm_files/libs/clipboard/clipboard.min.js"></script>
<script src="datacamp_rstanarm_files/libs/quarto-html/quarto.js"></script>
<script src="datacamp_rstanarm_files/libs/quarto-html/popper.min.js"></script>
<script src="datacamp_rstanarm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="datacamp_rstanarm_files/libs/quarto-html/anchor.min.js"></script>
<link href="datacamp_rstanarm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="datacamp_rstanarm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="datacamp_rstanarm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="datacamp_rstanarm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="datacamp_rstanarm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="datacamp_rstanarm_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="datacamp_rstanarm_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DataCamp: Bayesian Regression Modeling with rstanarm</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="at">scheme =</span> <span class="st">"brightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction-to-bayesian-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-bayesian-linear-models">Introduction to Bayesian Linear Models</h2>
<p>A review of frequentist regression using <code>lm()</code>, an introduction to Bayesian regression using <code>stan_glm()</code>, and a comparison of the respective outputs.</p>
<section id="non-bayesian-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="non-bayesian-linear-regression">Non-Bayesian linear regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kid_score ~ mom_iq, data = kidiq)

Residuals:
   Min     1Q Median     3Q    Max 
-56.75 -12.07   2.22  11.71  47.69 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  25.7998     5.9174    4.36             0.000016 ***
mom_iq        0.6100     0.0585   10.42 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.3 on 432 degrees of freedom
Multiple R-squared:  0.201, Adjusted R-squared:  0.199 
F-statistic:  109 on 1 and 432 DF,  p-value: &lt;0.0000000000000002</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   25.8      5.92        4.36 1.63e- 5
2 mom_iq         0.610    0.0585     10.4  7.66e-23</code></pre>
</div>
</div>
</section>
<section id="bayesian-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-linear-regression">Bayesian linear regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 3.2e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.32 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.021 seconds (Warm-up)
Chain 1:                0.04 seconds (Sampling)
Chain 1:                0.061 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.026 seconds (Warm-up)
Chain 2:                0.045 seconds (Sampling)
Chain 2:                0.071 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 9e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.02 seconds (Warm-up)
Chain 3:                0.042 seconds (Sampling)
Chain 3:                0.062 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 5e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.023 seconds (Warm-up)
Chain 4:                0.044 seconds (Sampling)
Chain 4:                0.067 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_iq
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 434
 predictors:   2

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 25.8    5.9 18.2  25.7  33.3 
mom_iq       0.6    0.1  0.5   0.6   0.7 
sigma       18.3    0.6 17.5  18.3  19.1 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 86.8    1.2 85.3  86.8  88.4 

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.1  1.0  3613 
mom_iq        0.0  1.0  3600 
sigma         0.0  1.0  4191 
mean_PPD      0.0  1.0  4028 
log-posterior 0.0  1.0  2187 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  term        estimate std.error
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   25.7      6.08  
2 mom_iq         0.610    0.0598</code></pre>
</div>
</div>
</section>
<section id="assessing-model-convergence" class="level3">
<h3 class="anchored" data-anchor-id="assessing-model-convergence">Assessing model convergence</h3>
<p>Rhat should be less than 1.1</p>
</section>
<section id="comparing-frequentist-and-bayesian-inferences" class="level3">
<h3 class="anchored" data-anchor-id="comparing-frequentist-and-bayesian-inferences">Comparing frequentist and Bayesian inferences</h3>
<ul>
<li>Frequentist inference: data are random, parameters are fixed; p-value = P(random data/sample/test statistic | null hypothesis/parameter = 0)</li>
<li>Bayesian inference: data are fixed, parameters are random; posterior = P(parameter | observed data/sample)</li>
<li>Use credible interval of posterior distribution to check if parameter is diff from zero (or any other hypothesis)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability that true param value is in interval</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_interval</span>(stan_model, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5%   97.5%
(Intercept) 14.4515 37.2936
mom_iq       0.4983  0.7212
sigma       17.1717 19.5836</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability that interval contains true param value</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm_model, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             2.5 % 97.5 %
(Intercept) 14.169 37.430
mom_iq       0.495  0.725</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(stan_model, mom_iq)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">between</span>(posterior<span class="sc">$</span>mom_iq, <span class="fl">0.60</span>, <span class="fl">0.65</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3152</code></pre>
</div>
</div>
</section>
</section>
<section id="modifying-a-bayesian-model" class="level2">
<h2 class="anchored" data-anchor-id="modifying-a-bayesian-model">Modifying a Bayesian Model</h2>
<p>Learn how to modify your Bayesian model including changing the number and length of chains, changing prior distributions, and adding predictors.</p>
<section id="changing-number-and-length-of-chains" class="level3">
<h3 class="anchored" data-anchor-id="changing-number-and-length-of-chains">Changing number and length of chains</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">warmup =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.012 seconds (Warm-up)
Chain 1:                0.022 seconds (Sampling)
Chain 1:                0.034 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 5e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.013 seconds (Warm-up)
Chain 2:                0.022 seconds (Sampling)
Chain 2:                0.035 seconds (Total)
Chain 2: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      kid_score ~ mom_iq
 algorithm:    sampling
 sample:       1000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 434
 predictors:   2

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 25.8    5.9 18.0  25.9  33.5 
mom_iq       0.6    0.1  0.5   0.6   0.7 
sigma       18.3    0.6 17.5  18.3  19.1 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 86.8    1.2 85.4  86.8  88.4 

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.2  1.0  1069 
mom_iq        0.0  1.0  1062 
sigma         0.0  1.0   880 
mean_PPD      0.0  1.0  1001 
log-posterior 0.1  1.0   465 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
</section>
<section id="changing-prior-distributions" class="level3">
<h3 class="anchored" data-anchor-id="changing-prior-distributions">Changing prior distributions</h3>
<p><img src="images/clipboard-2312457615.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Priors for model 'stan_model' 
------
Intercept (after predictors centered)
  Specified prior:
    ~ normal(location = 87, scale = 2.5)
  Adjusted prior:
    ~ normal(location = 87, scale = 51)

Coefficients
  Specified prior:
    ~ normal(location = 0, scale = 2.5)
  Adjusted prior:
    ~ normal(location = 0, scale = 3.4)

Auxiliary (sigma)
  Specified prior:
    ~ exponential(rate = 1)
  Adjusted prior:
    ~ exponential(rate = 0.049)
------
See help('prior_summary.stanreg') for more details</code></pre>
</div>
</div>
<p>Adjusted scale is <code>2.5 * sd(y)</code> for the intercept, and <code>2.5 * sd(y)/sd(x)</code> for the coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.5</span> <span class="sc">*</span> <span class="fu">sd</span>(kidiq<span class="sc">$</span>kid_score) <span class="co"># intercept</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51.03</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.5</span> <span class="sc">*</span> <span class="fu">sd</span>(kidiq<span class="sc">$</span>kid_score) <span class="sc">/</span> <span class="fu">sd</span>(kidiq<span class="sc">$</span>mom_iq) <span class="co"># coefficient</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.402</code></pre>
</div>
</div>
<p>Auto-scale can be turned off:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># n.b.: autoscale = FALSE is the default when manually specifying priors</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_intercept =</span> <span class="fu">normal</span>(),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior =</span> <span class="fu">normal</span>(),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_aux =</span> <span class="fu">exponential</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.027 seconds (Warm-up)
Chain 1:                0.049 seconds (Sampling)
Chain 1:                0.076 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.027 seconds (Warm-up)
Chain 2:                0.056 seconds (Sampling)
Chain 2:                0.083 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 7e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.031 seconds (Warm-up)
Chain 3:                0.052 seconds (Sampling)
Chain 3:                0.083 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 6e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.03 seconds (Warm-up)
Chain 4:                0.052 seconds (Sampling)
Chain 4:                0.082 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Priors for model 'stan_model' 
------
Intercept (after predictors centered)
 ~ normal(location = 0, scale = 2.5)

Coefficients
 ~ normal(location = 0, scale = 2.5)

Auxiliary (sigma)
 ~ exponential(rate = 1)
------
See help('prior_summary.stanreg') for more details</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="at">location =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">2</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior =</span> <span class="fu">cauchy</span>(<span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.7e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.038 seconds (Warm-up)
Chain 1:                0.05 seconds (Sampling)
Chain 1:                0.088 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.034 seconds (Warm-up)
Chain 2:                0.054 seconds (Sampling)
Chain 2:                0.088 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 6e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.039 seconds (Warm-up)
Chain 3:                0.058 seconds (Sampling)
Chain 3:                0.097 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 4e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.033 seconds (Warm-up)
Chain 4:                0.053 seconds (Sampling)
Chain 4:                0.086 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Priors for model 'stan_model' 
------
Intercept (after predictors centered)
 ~ normal(location = 3, scale = 2)

Coefficients
 ~ cauchy(location = 0, scale = 1)

Auxiliary (sigma)
  Specified prior:
    ~ exponential(rate = 1)
  Adjusted prior:
    ~ exponential(rate = 0.049)
------
See help('prior_summary.stanreg') for more details</code></pre>
</div>
</div>
<p>A prior distribution should reflect that expected distribution of the parameter it is applied to!</p>
<p>A prior can be seen as having more data in addition to the observed ones; specifying a highly informative prior is like having a lot of additional data, therefore if we donâ€™t have a lot of observed data, it can strongly influence the posterior!</p>
<p>Flat priors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_intercept =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_aux =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 6e-06 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.018 seconds (Warm-up)
Chain 1:                0.04 seconds (Sampling)
Chain 1:                0.058 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 4e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.016 seconds (Warm-up)
Chain 2:                0.041 seconds (Sampling)
Chain 2:                0.057 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 2e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.02 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.018 seconds (Warm-up)
Chain 3:                0.041 seconds (Sampling)
Chain 3:                0.059 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.018 seconds (Warm-up)
Chain 4:                0.041 seconds (Sampling)
Chain 4:                0.059 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Priors for model 'stan_model' 
------
Intercept (after predictors centered)
 ~ flat

Coefficients
 ~ flat

Auxiliary (sigma)
 ~ flat
------
See help('prior_summary.stanreg') for more details</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"frequentist"</span> <span class="ot">=</span> lm_model, <span class="st">"bayesian"</span> <span class="ot">=</span> stan_model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 
`modelsummary` uses the `performance` package to extract goodness-of-fit
statistics from models of this class. You can specify the statistics you wish
to compute by supplying a `metrics` argument to `modelsummary`, which will then
push it forward to `performance`. Acceptable values are: "all", "common",
"none", or a character vector of metrics names. For example: `modelsummary(mod,
metrics = c("RMSE", "R2")` Note that some metrics are computationally
expensive. See `?performance::performance` for details.
 This warning appears once per session.</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">frequentist</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">bayesian</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">25.800</td>
<td style="text-align: center;">25.783</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(5.917)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">mom_iq</td>
<td style="text-align: center;">0.610</td>
<td style="text-align: center;">0.610</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1.5px;"></td>
<td style="text-align: center; box-shadow: 0px 1.5px;">(0.059)</td>
<td style="text-align: center; box-shadow: 0px 1.5px;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">434</td>
<td style="text-align: center;">434</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: center;">0.201</td>
<td style="text-align: center;">0.200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.199</td>
<td style="text-align: center;">0.196</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: center;">3757.2</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: center;">3769.4</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: center;">âˆ’1875.608</td>
<td style="text-align: center;">âˆ’1876.306</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: center;">108.643</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ELPD</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">âˆ’1878.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELPD s.e.</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">14.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">LOOIC</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">3757.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOOIC s.e.</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">28.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">WAIC</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">3757.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">18.22</td>
<td style="text-align: center;">18.22</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="altering-the-estimation-process" class="level3">
<h3 class="anchored" data-anchor-id="altering-the-estimation-process">Altering the estimation process</h3>
<p>Estimation errors (like non-convergence) are threats to the validity of the parameter estimates</p>
<p>Divergent transitions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>)) <span class="co"># increase from 0.95 default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.4e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.14 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.021 seconds (Warm-up)
Chain 1:                0.045 seconds (Sampling)
Chain 1:                0.066 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 5e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.023 seconds (Warm-up)
Chain 2:                0.044 seconds (Sampling)
Chain 2:                0.067 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 9e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.022 seconds (Warm-up)
Chain 3:                0.042 seconds (Sampling)
Chain 3:                0.064 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 5e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.025 seconds (Warm-up)
Chain 4:                0.043 seconds (Sampling)
Chain 4:                0.068 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<p>Exceeding the max treedepth:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max_treedepth =</span> <span class="dv">15</span>)) <span class="co"># increase from 10 default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.1 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.023 seconds (Warm-up)
Chain 1:                0.044 seconds (Sampling)
Chain 1:                0.067 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 6e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.06 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.025 seconds (Warm-up)
Chain 2:                0.041 seconds (Sampling)
Chain 2:                0.066 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 4e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.022 seconds (Warm-up)
Chain 3:                0.041 seconds (Sampling)
Chain 3:                0.063 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.022 seconds (Warm-up)
Chain 4:                0.041 seconds (Sampling)
Chain 4:                0.063 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
</section>
</section>
<section id="assessing-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="assessing-model-fit">Assessing Model Fit</h2>
<p>In this chapter, weâ€™ll learn how to determine if our estimated model fits our data and how to compare competing models.</p>
<section id="r-squared" class="level3">
<h3 class="anchored" data-anchor-id="r-squared">R-squared</h3>
<p><span class="math inline">\(R^2\)</span> = proportion of total variance explained by the linear predictor (deterministic component of the linear regression model) = coefficient of determination = <span class="math inline">\(1 - \frac{\sum_i(y_i - \hat y_i)^2}{\sum_i (y_i - \bar y)^2}\)</span></p>
<p><img src="images/clipboard-4133301828.png" class="img-fluid" width="440"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_model)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>lm_summary<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(lm_model))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(lm_model)) <span class="sc">+</span> <span class="fu">var</span>(<span class="fu">fitted</span>(lm_model))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (ss_res <span class="sc">/</span> ss_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(lm_model))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">var</span>(kidiq<span class="sc">$</span>kid_score)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (ss_res <span class="sc">/</span> ss_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.201</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ss_res <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(stan_model))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ss_total <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(stan_model)) <span class="sc">+</span> <span class="fu">var</span>(<span class="fu">fitted</span>(stan_model))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (ss_res <span class="sc">/</span> ss_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.201</code></pre>
</div>
</div>
</section>
<section id="posterior-predictive-model-checks" class="level3">
<h3 class="anchored" data-anchor-id="posterior-predictive-model-checks">Posterior predictive model checks</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spread_draws</span>(stan_model, <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, mom_iq) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>.draw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 Ã— 4
   .chain .iteration `(Intercept)` mom_iq
    &lt;int&gt;      &lt;int&gt;         &lt;dbl&gt;  &lt;dbl&gt;
 1      1          1          26.9  0.595
 2      1          2          27.5  0.585
 3      1          3          25.7  0.610
 4      1          4          21.7  0.641
 5      1          5          21.9  0.638
 6      1          6          24.0  0.632
 7      1          7          27.3  0.591
 8      1          8          28.4  0.577
 9      1          9          30.7  0.546
10      1         10          26.1  0.602
# â„¹ 3,990 more rows</code></pre>
</div>
</div>
<p>Posterior predictions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(kidiq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 434</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for each iteration, predict outcome of each observation using the parameter values at that iteration</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">posterior_linpred</span>(stan_model)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>predictions <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 Ã— 434
     `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10`  `11`  `12`  `13`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  99.0  80.1  95.6  86.1  82.1  91.1  110. 101.   75.5  83.5  79.6  83.3  79.8
 2  98.3  79.7  95.0  85.6  81.7  90.6  109. 101.   75.2  83.1  79.3  83.0  79.5
 3  99.6  80.2  96.1  86.4  82.3  91.5  110. 102.   75.5  83.7  79.7  83.6  80.0
 4  99.4  79.1  95.8  85.5  81.2  90.9  111. 102.   74.1  82.7  78.5  82.6  78.8
 5  99.2  78.9  95.6  85.3  81.1  90.7  111. 102.   74.0  82.6  78.4  82.4  78.7
 6 101.   80.4  96.9  86.8  82.6  92.2  112. 103.   75.6  84.1  80.0  83.9  80.2
 7  98.9  80.2  95.6  86.1  82.2  91.1  109. 101.   75.6  83.5  79.7  83.4  79.9
 8  98.2  79.9  95.0  85.7  81.9  90.6  108. 101.   75.4  83.2  79.5  83.1  79.7
 9  96.9  79.5  93.8  85.0  81.4  89.7  107.  99.1  75.3  82.6  79.1  82.5  79.3
10  99.1  80.0  95.7  86.0  82.0  91.1  110. 102.   75.3  83.4  79.5  83.3  79.7
    `14`  `15`  `16`  `17`  `18`  `19`  `20`  `21`  `22`  `23`  `24`  `25`  `26`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  94.8  86.7  98.5  95.0  93.3  107.  84.8  92.4 102.   85.2  86.3  85.0  99.3
 2  94.2  86.3  97.9  94.4  92.7  106.  84.4  91.9 102.   84.7  85.9  84.5  98.7
 3  95.3  87.0  99.2  95.5  93.8  107.  85.0  92.9 103.   85.4  86.6  85.2 100. 
 4  94.9  86.2  99.0  95.1  93.3  108.  84.1  92.3 103.   84.5  85.8  84.3  99.8
 5  94.7  86.0  98.7  94.9  93.1  107.  84.0  92.1 103.   84.4  85.7  84.2  99.6
 6  96.1  87.5 100.   96.3  94.5  109.  85.4  93.5 104.   85.9  87.1  85.7 101. 
 7  94.8  86.8  98.5  95.0  93.3  106.  84.8  92.4 102.   85.2  86.4  85.0  99.3
 8  94.2  86.4  97.8  94.4  92.7  106.  84.5  91.9 101.   84.8  86.0  84.7  98.6
 9  93.0  85.6  96.5  93.2  91.7  104.  83.8  90.9  99.9  84.2  85.3  84.0  97.2
10  94.9  86.7  98.7  95.1  93.4  107.  84.7  92.5 102.   85.1  86.3  84.9  99.5
    `27`  `28`  `29`  `30`  `31`  `32`  `33`  `34`  `35`  `36`  `37`  `38`  `39`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  85.6  85.2  74.7  94.9  91.8  87.5  97.1  91.5  84.3  82.2  84.0  90.6  78.8
 2  85.2  84.7  74.5  94.3  91.3  87.0  96.5  91.0  83.9  81.8  83.6  90.1  78.5
 3  85.9  85.4  74.7  95.4  92.3  87.8  97.7  92.0  84.6  82.3  84.2  91.0  78.9
 4  85.1  84.5  73.3  95.1  91.7  87.0  97.4  91.4  83.6  81.3  83.2  90.4  77.7
 5  84.9  84.4  73.2  94.8  91.5  86.9  97.2  91.2  83.5  81.2  83.1  90.2  77.5
 6  86.4  85.9  74.8  96.2  92.9  88.3  98.5  92.6  85.0  82.7  84.6  91.6  79.1
 7  85.7  85.2  74.8  94.9  91.8  87.5  97.1  91.5  84.4  82.2  84.0  90.6  78.9
 8  85.3  84.8  74.7  94.3  91.3  87.1  96.4  91.0  84.0  81.9  83.7  90.1  78.7
 9  84.7  84.2  74.6  93.1  90.3  86.3  95.1  90.1  83.4  81.4  83.1  89.2  78.3
10  85.6  85.1  74.5  95.0  91.9  87.5  97.2  91.6  84.3  82.1  83.9  90.6  78.7
    `40`  `41`  `42`  `43`  `44`  `45`  `46`  `47`  `48`  `49`  `50`  `51`  `52`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  80.1  87.9  104.  76.5 102.   77.9 102.   74.0  94.2  92.5  86.0  87.8 101. 
 2  79.7  87.4  104.  76.3 101.   77.7 101.   73.8  93.7  92.0  85.6  87.4 101. 
 3  80.2  88.2  105.  76.6 102.   78.0 103.   74.0  94.7  93.0  86.3  88.2 102. 
 4  79.1  87.5  105.  75.2 102.   76.8 103.   72.5  94.3  92.5  85.5  87.4 102. 
 5  78.9  87.3  105.  75.1 102.   76.6 103.   72.4  94.1  92.3  85.3  87.2 102. 
 6  80.4  88.8  106.  76.7 103.   78.2 104.   74.0  95.5  93.7  86.8  88.7 103. 
 7  80.2  87.9  104.  76.6 102.   78.1 102.   74.1  94.2  92.6  86.1  87.9 101. 
 8  79.9  87.5  103.  76.5 101.   77.9 101.   74.0  93.6  92.0  85.7  87.4 100. 
 9  79.5  86.7  102.  76.3  99.4  77.6  99.8  74.0  92.5  91.0  85.0  86.7  98.9
10  80.0  87.9  105.  76.4 102.   77.8 102.   73.9  94.3  92.6  86.0  87.8 101. 
    `53`  `54`  `55`  `56`  `57`  `58`  `59`  `60`  `61`  `62`  `63`  `64`  `65`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  83.3  81.9  87.5  74.4  84.1  75.9  72.5  92.4  93.3  94.5  87.1  87.2  87.4
 2  83.0  81.5  87.0  74.2  83.7  75.6  72.3  91.8  92.7  93.9  86.6  86.7  86.9
 3  83.6  82.0  87.8  74.4  84.4  75.9  72.4  92.8  93.8  95.0  87.4  87.5  87.7
 4  82.6  81.0  87.0  72.9  83.5  74.6  70.9  92.3  93.3  94.6  86.6  86.7  87.0
 5  82.4  80.8  86.9  72.8  83.3  74.4  70.8  92.1  93.1  94.4  86.4  86.6  86.8
 6  83.9  82.3  88.3  74.4  84.8  76.0  72.4  93.5  94.5  95.8  87.9  88.0  88.2
 7  83.4  81.9  87.5  74.5  84.2  76.0  72.6  92.4  93.3  94.5  87.1  87.2  87.4
 8  83.1  81.6  87.1  74.4  83.9  75.9  72.5  91.8  92.7  93.9  86.7  86.8  87.0
 9  82.5  81.2  86.3  74.3  83.3  75.7  72.6  90.8  91.7  92.8  86.0  86.1  86.3
10  83.3  81.8  87.5  74.2  84.1  75.8  72.3  92.4  93.4  94.6  87.1  87.2  87.4
    `66`  `67`  `68`  `69`  `70`  `71`  `72`  `73`  `74`  `75`  `76`  `77`  `78`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  85.7  82.5  78.8  78.8  78.2  80.3  99.4  103.  92.3  80.7  79.8  94.2  73.3
 2  85.3  82.2  78.5  78.5  77.9  80.0  98.7  102.  91.8  80.4  79.5  93.6  73.1
 3  86.0  82.7  78.9  78.9  78.3  80.5 100.   103.  92.8  80.9  79.9  94.7  73.3
 4  85.1  81.7  77.7  77.7  77.0  79.4  99.9  104.  92.3  79.7  78.8  94.2  71.8
 5  84.9  81.6  77.6  77.6  76.9  79.2  99.7  103.  92.1  79.6  78.6  94.0  71.7
 6  86.4  83.1  79.1  79.2  78.5  80.7 101.   105.  93.5  81.1  80.2  95.4  73.3
 7  85.7  82.6  78.9  78.9  78.3  80.4  99.4  103.  92.4  80.8  79.9  94.2  73.4
 8  85.4  82.3  78.7  78.7  78.1  80.2  98.7  102.  91.8  80.5  79.6  93.6  73.4
 9  84.7  81.8  78.4  78.4  77.8  79.8  97.3  100.  90.8  80.1  79.3  92.5  73.3
10  85.7  82.5  78.7  78.7  78.1  80.3  99.6  103.  92.4  80.6  79.7  94.2  73.1
    `79`  `80`  `81`  `82`  `83`  `84`  `85`  `86`  `87`  `88`  `89`  `90`  `91`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  83.6  76.6  78.2  83.6  93.1  102.  80.4  86.0  75.2  92.7  108. 101.   107.
 2  83.3  76.4  77.9  83.3  92.5  102.  80.1  85.5  74.9  92.1  107.  99.9  106.
 3  83.9  76.7  78.3  83.9  93.6  103.  80.6  86.2  75.2  93.1  109. 101.   108.
 4  82.9  75.4  77.1  82.9  93.1  103.  79.4  85.4  73.8  92.6  109. 101.   108.
 5  82.8  75.2  76.9  82.8  92.9  103.  79.3  85.2  73.7  92.4  109. 101.   108.
 6  84.3  76.8  78.5  84.3  94.3  104.  80.8  86.7  75.3  93.8  110. 102.   109.
 7  83.7  76.8  78.3  83.7  93.1  102.  80.5  86.0  75.3  92.7  108. 101.   107.
 8  83.4  76.6  78.1  83.4  92.5  102.  80.2  85.6  75.2  92.1  107.  99.8  106.
 9  82.8  76.4  77.8  82.8  91.5  100.  79.9  84.9  75.1  91.1  105.  98.4  104.
10  83.6  76.5  78.1  83.6  93.2  103.  80.3  85.9  75.0  92.7  108. 101.   107.
    `92`  `93`  `94`  `95`  `96`  `97`  `98`  `99` `100` `101` `102` `103` `104`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  81.1  88.3 102.   103.  81.9  77.3  86.7  91.2  73.8  99.0  88.2  86.7  79.6
 2  80.8  87.9 101.   102.  81.6  77.1  86.3  90.6  73.6  98.3  87.7  86.2  79.3
 3  81.3  88.7 103.   103.  82.1  77.4  87.0  91.6  73.8  99.6  88.6  87.0  79.7
 4  80.2  88.0 103.   104.  81.0  76.1  86.2  91.0  72.3  99.4  87.8  86.2  78.5
 5  80.0  87.8 102.   103.  80.9  76.0  86.0  90.8  72.2  99.2  87.7  86.0  78.4
 6  81.5  89.2 104.   105.  82.4  77.6  87.5  92.2  73.8 101.   89.1  87.4  79.9
 7  81.2  88.4 102.   103.  82.0  77.5  86.8  91.2  73.9  98.9  88.3  86.7  79.7
 8  80.9  87.9 101.   102.  81.7  77.3  86.4  90.7  73.8  98.2  87.8  86.3  79.4
 9  80.5  87.1  99.7  100.  81.2  77.0  85.6  89.7  73.8  96.9  87.0  85.6  79.1
10  81.0  88.3 102.   103.  81.8  77.2  86.7  91.2  73.6  99.1  88.2  86.6  79.5
   `105` `106` `107` `108` `109` `110` `111` `112` `113` `114` `115` `116` `117`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  77.6  98.0  80.8  84.2  103.  98.2  93.5  81.9  84.0  81.3  88.2  86.5  80.3
 2  77.4  97.3  80.4  83.8  102.  97.6  93.0  81.6  83.6  80.9  87.8  86.1  80.0
 3  77.7  98.6  80.9  84.5  104.  98.8  94.0  82.1  84.3  81.4  88.6  86.8  80.5
 4  76.4  98.3  79.8  83.5  104.  98.6  93.6  81.1  83.3  80.4  87.8  86.0  79.3
 5  76.3  98.1  79.7  83.4  103.  98.4  93.4  80.9  83.2  80.2  87.7  85.9  79.2
 6  77.9  99.5  81.2  84.9  105.  99.7  94.8  82.4  84.7  81.7  89.1  87.3  80.7
 7  77.8  97.9  80.9  84.3  103.  98.2  93.6  82.0  84.1  81.4  88.3  86.6  80.4
 8  77.6  97.3  80.6  83.9  102.  97.5  93.0  81.7  83.8  81.1  87.8  86.2  80.2
 9  77.3  96.0  80.2  83.3  100.  96.2  91.9  81.3  83.2  80.7  87.0  85.5  79.8
10  77.5  98.1  80.7  84.2  103.  98.3  93.6  81.9  84.0  81.2  88.2  86.5  80.2
   `118` `119` `120` `121` `122` `123` `124` `125` `126` `127` `128` `129` `130`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  95.4  84.4  89.7  85.0  105.  87.5  82.5  88.8  88.6  90.8  82.0  83.1  82.3
 2  94.8  84.0  89.2  84.6  105.  87.0  82.2  88.3  88.1  90.3  81.6  82.7  81.9
 3  95.9  84.6  90.1  85.3  106.  87.8  82.7  89.1  89.0  91.2  82.1  83.3  82.5
 4  95.5  83.7  89.5  84.4  106.  87.0  81.7  88.5  88.3  90.6  81.1  82.3  81.5
 5  95.3  83.6  89.3  84.2  106.  86.9  81.6  88.3  88.1  90.4  80.9  82.2  81.3
 6  96.7  85.1  90.7  85.7  107.  88.3  83.1  89.7  89.5  91.8  82.5  83.7  82.8
 7  95.3  84.5  89.7  85.1  105.  87.5  82.6  88.8  88.6  90.8  82.0  83.2  82.4
 8  94.7  84.1  89.3  84.7  104.  87.1  82.3  88.4  88.2  90.3  81.7  82.8  82.1
 9  93.6  83.5  88.4  84.1  103.  86.3  81.8  87.5  87.4  89.4  81.3  82.3  81.6
10  95.5  84.4  89.7  85.0  106.  87.5  82.5  88.8  88.6  90.8  81.9  83.0  82.3
   `131` `132` `133` `134` `135` `136` `137` `138` `139` `140` `141` `142` `143`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  76.5  69.2  103.  95.7  81.0  106.  70.0  86.8  106.  85.5  95.7  96.5  108.
 2  76.3  69.0  102.  95.1  80.7  105.  69.9  86.4  105.  85.1  95.1  95.9  107.
 3  76.6  69.0  104.  96.3  81.2  107.  69.9  87.1  107.  85.8  96.2  97.1  109.
 4  75.2  67.3  104.  95.9  80.1  107.  68.2  86.3  107.  84.9  95.9  96.8  109.
 5  75.1  67.2  103.  95.7  79.9  107.  68.2  86.2  107.  84.8  95.7  96.6  109.
 6  76.7  68.9  105.  97.1  81.5  108.  69.8  87.6  108.  86.3  97.1  97.9  110.
 7  76.6  69.3  103.  95.7  81.1  106.  70.2  86.9  106.  85.6  95.7  96.5  108.
 8  76.5  69.3  102.  95.1  80.8  105.  70.2  86.5  105.  85.2  95.1  95.9  107.
 9  76.3  69.5  100.  93.9  80.4  103.  70.3  85.7  103.  84.5  93.9  94.7  105.
10  76.4  68.9  103.  95.8  80.9  106.  69.8  86.8  106.  85.5  95.8  96.7  108.
   `144` `145` `146` `147` `148` `149` `150` `151` `152` `153` `154` `155` `156`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.3  107.  89.2  86.0  86.7  80.2  98.8  94.2 102.   99.9  95.5  81.4  79.6
 2  89.8  106.  88.7  85.6  86.2  79.8  98.2  93.6 101.   99.3  94.9  81.0  79.3
 3  90.7  108.  89.5  86.3  87.0  80.3  99.5  94.7 103.  101.   96.1  81.6  79.8
 4  90.1  108.  88.9  85.5  86.2  79.2  99.3  94.3 103.  100.   95.7  80.5  78.6
 5  89.9  107.  88.7  85.3  86.0  79.0  99.1  94.1 103.  100.   95.5  80.3  78.5
 6  91.3  109.  90.1  86.8  87.4  80.6 100.   95.5 104.  102.   96.9  81.9  80.0
 7  90.3  107.  89.2  86.1  86.7  80.3  98.8  94.2 102.   99.9  95.5  81.5  79.7
 8  89.8  106.  88.7  85.7  86.3  80.0  98.1  93.6 101.   99.2  94.9  81.2  79.5
 9  88.9  104.  87.9  85.0  85.6  79.6  96.8  92.5  99.8  97.8  93.7  80.8  79.1
10  90.3  107.  89.2  86.0  86.6  80.1  99.0  94.3 102.  100.   95.6  81.3  79.5
   `157` `158` `159` `160` `161` `162` `163` `164` `165` `166` `167` `168` `169`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.7  89.4  88.7  92.4  79.5  96.5 102.   99.8  98.9  82.3  86.0 101.   94.2
 2  90.2  88.9  88.2  91.9  79.2  95.9 101.   99.2  98.3  81.9  85.6  99.9  93.6
 3  91.1  89.7  89.0  92.9  79.6  97.1 102.  100.   99.5  82.5  86.3 101.   94.6
 4  90.5  89.1  88.4  92.3  78.5  96.8 102.  100.   99.4  81.5  85.5 101.   94.2
 5  90.3  88.9  88.2  92.1  78.3  96.6 102.  100.   99.1  81.3  85.3 101.   94.0
 6  91.7  90.3  89.6  93.5  79.9  97.9 103.  101.  100.   82.8  86.8 102.   95.4
 7  90.7  89.4  88.7  92.4  79.6  96.5 102.   99.8  98.9  82.4  86.1 101.   94.2
 8  90.2  88.9  88.3  91.9  79.4  95.9 101.   99.1  98.2  82.1  85.7  99.8  93.6
 9  89.3  88.1  87.4  90.9  79.0  94.6  99.3  97.7  96.8  81.6  85.0  98.4  92.5
10  90.7  89.4  88.7  92.5  79.4  96.6 102.  100.   99.1  82.3  86.0 101.   94.2
   `170` `171` `172` `173` `174` `175` `176` `177` `178` `179` `180` `181` `182`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  95.8  95.3  82.6  99.3  80.7  76.5  86.1  94.7  85.0  80.3  98.0  84.8  77.4
 2  95.2  94.7  82.2  98.7  80.3  76.3  85.7  94.1  84.5  80.0  97.4  84.4  77.1
 3  96.3  95.8  82.8 100.   80.8  76.6  86.4  95.2  85.2  80.5  98.6  85.1  77.5
 4  96.0  95.5  81.8  99.8  79.7  75.2  85.5  94.8  84.3  79.3  98.4  84.2  76.2
 5  95.8  95.2  81.6  99.6  79.5  75.1  85.4  94.6  84.2  79.2  98.2  84.0  76.1
 6  97.1  96.6  83.1 101.   81.1  76.7  86.8  96.0  85.7  80.7  99.5  85.5  77.6
 7  95.8  95.3  82.7  99.3  80.7  76.6  86.1  94.7  85.0  80.4  98.0  84.9  77.5
 8  95.1  94.7  82.4  98.6  80.5  76.5  85.7  94.1  84.7  80.2  97.3  84.5  77.3
 9  93.9  93.5  81.9  97.2  80.1  76.3  85.1  92.9  84.0  79.8  96.0  83.9  77.1
10  95.9  95.4  82.5  99.5  80.6  76.4  86.1  94.8  84.9  80.2  98.2  84.8  77.3
   `183` `184` `185` `186` `187` `188` `189` `190` `191` `192` `193` `194` `195`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  87.8  86.0  85.8  84.6  91.3  86.7  86.1  94.7  82.1  79.3  90.0  88.3  86.0
 2  87.3  85.5  85.4  84.2  90.8  86.3  85.7  94.1  81.7  79.0  89.5  87.8  85.5
 3  88.1  86.2  86.1  84.8  91.8  87.0  86.4  95.2  82.3  79.4  90.4  88.7  86.3
 4  87.4  85.4  85.3  83.9  91.2  86.2  85.5  94.8  81.2  78.2  89.8  87.9  85.4
 5  87.2  85.2  85.1  83.7  91.0  86.0  85.4  94.6  81.1  78.1  89.6  87.8  85.3
 6  88.6  86.7  86.6  85.2  92.4  87.5  86.8  96.0  82.6  79.6  91.0  89.2  86.7
 7  87.8  86.0  85.9  84.6  91.4  86.8  86.1  94.7  82.2  79.4  90.1  88.4  86.0
 8  87.4  85.6  85.5  84.3  90.8  86.4  85.7  94.1  81.9  79.1  89.6  87.9  85.6
 9  86.6  84.9  84.8  83.7  89.9  85.6  85.1  93.0  81.4  78.8  88.7  87.1  85.0
10  87.8  85.9  85.8  84.5  91.4  86.7  86.1  94.8  82.0  79.2  90.1  88.3  86.0
   `196` `197` `198` `199` `200` `201` `202` `203` `204` `205` `206` `207` `208`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.4  85.9  87.8  82.1  96.4  77.7  95.7  94.2  90.5  83.9  72.8  80.0  93.8
 2  89.9  85.5  87.4  81.8  95.8  77.4  95.1  93.7  90.0  83.5  72.6  79.7  93.2
 3  90.8  86.2  88.2  82.3  97.0  77.8  96.2  94.7  90.9  84.1  72.7  80.2  94.3
 4  90.2  85.3  87.4  81.3  96.7  76.5  95.9  94.3  90.3  83.2  71.2  79.0  93.8
 5  90.0  85.2  87.3  81.1  96.4  76.4  95.6  94.1  90.1  83.0  71.1  78.9  93.6
 6  91.4  86.6  88.7  82.7  97.8  78.0  97.0  95.5  91.5  84.5  72.7  80.4  95.0
 7  90.4  86.0  87.9  82.2  96.4  77.8  95.6  94.2  90.5  84.0  72.9  80.1  93.8
 8  89.9  85.6  87.5  81.9  95.8  77.6  95.0  93.6  90.0  83.6  72.8  79.9  93.2
 9  89.0  84.9  86.7  81.4  94.5  77.4  93.8  92.5  89.1  83.1  72.8  79.5  92.1
10  90.4  85.9  87.9  82.1  96.5  77.6  95.8  94.3  90.5  83.9  72.6  79.9  93.9
   `209` `210` `211` `212` `213` `214` `215` `216` `217` `218` `219` `220` `221`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  92.7  92.1  91.1  89.4  91.0  92.0  106.  104.  87.1  78.8  97.2  98.4  80.6
 2  92.2  91.5  90.6  88.9  90.4  91.5  106.  103.  86.7  78.5  96.5  97.8  80.3
 3  93.2  92.5  91.5  89.7  91.4  92.5  107.  104.  87.5  78.9  97.7  99.1  80.8
 4  92.7  92.0  90.9  89.1  90.8  91.9  107.  104.  86.7  77.7  97.5  98.9  79.7
 5  92.5  91.8  90.7  88.9  90.6  91.7  107.  104.  86.5  77.6  97.2  98.6  79.5
 6  93.9  93.2  92.2  90.3  92.0  93.1  108.  105.  88.0  79.2  98.6 100.   81.1
 7  92.7  92.1  91.1  89.4  91.0  92.0  106.  103.  87.2  78.9  97.1  98.4  80.7
 8  92.2  91.5  90.6  88.9  90.5  91.5  105.  103.  86.8  78.7  96.5  97.7  80.5
 9  91.1  90.5  89.7  88.1  89.5  90.5  104.  101.  86.0  78.4  95.2  96.4  80.1
10  92.8  92.1  91.1  89.4  91.0  92.1  107.  104.  87.1  78.7  97.3  98.6  80.6
   `222` `223` `224` `225` `226` `227` `228` `229` `230` `231` `232` `233` `234`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  74.4  108.  87.8  106.  84.2  97.2  97.2  87.3  83.0  77.3  78.5  104.  103.
 2  74.2  107.  87.4  105.  83.8  96.6  96.5  86.8  82.6  77.0  78.2  103.  102.
 3  74.4  109.  88.2  107.  84.4  97.8  97.7  87.6  83.2  77.3  78.6  105.  104.
 4  73.0  109.  87.4  107.  83.5  97.6  97.5  86.8  82.2  76.0  77.4  105.  104.
 5  72.9  109.  87.2  107.  83.3  97.3  97.2  86.7  82.1  75.9  77.3  104.  103.
 6  74.5  110.  88.7  108.  84.8  98.7  98.6  88.1  83.6  77.5  78.8  106.  105.
 7  74.6  108.  87.9  106.  84.3  97.2  97.1  87.3  83.1  77.4  78.6  104.  103.
 8  74.5  107.  87.4  105.  83.9  96.5  96.5  86.9  82.8  77.2  78.4  103.  102.
 9  74.4  105.  86.7  103.  83.3  95.3  95.2  86.2  82.2  77.0  78.1  101.  101.
10  74.3  108.  87.8  106.  84.1  97.4  97.3  87.3  83.0  77.1  78.4  104.  103.
   `235` `236` `237` `238` `239` `240` `241` `242` `243` `244` `245` `246` `247`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.5  89.8  96.5  97.9  88.0  91.3 102.   87.5  85.9  81.5  77.0  77.1  74.0
 2  90.0  89.3  95.9  97.3  87.6  90.8 101.   87.1  85.5  81.2  76.7  76.8  73.7
 3  90.9  90.2  97.1  98.5  88.4  91.7 103.   87.8  86.2  81.7  77.0  77.1  73.9
 4  90.3  89.6  96.8  98.3  87.6  91.1 103.   87.1  85.3  80.6  75.7  75.8  72.5
 5  90.1  89.4  96.6  98.0  87.5  90.9 103.   86.9  85.2  80.5  75.6  75.7  72.4
 6  91.5  90.8  97.9  99.4  88.9  92.4 104.   88.4  86.6  82.0  77.2  77.3  74.0
 7  90.5  89.8  96.5  97.9  88.1  91.3 102.   87.6  85.9  81.6  77.1  77.2  74.1
 8  90.0  89.4  95.9  97.2  87.6  90.8 101.   87.1  85.6  81.3  76.9  77.0  74.0
 9  89.1  88.5  94.6  95.9  86.8  89.8  99.8  86.4  84.9  80.9  76.7  76.8  73.9
10  90.5  89.8  96.6  98.0  88.0  91.3 102.   87.5  85.9  81.4  76.8  77.0  73.8
   `248` `249` `250` `251` `252` `253` `254` `255` `256` `257` `258` `259` `260`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  81.3  80.7  73.9  91.9  72.6  85.0  104.  94.5  94.8  93.8  71.7  75.4  88.0
 2  80.9  80.4  73.7  91.4  72.4  84.5  103.  93.9  94.3  93.3  71.5  75.2  87.5
 3  81.4  80.9  73.9  92.3  72.5  85.2  104.  95.0  95.4  94.3  71.6  75.4  88.3
 4  80.4  79.7  72.4  91.8  71.0  84.3  104.  94.6  95.0  93.9  70.1  74.0  87.6
 5  80.2  79.6  72.3  91.6  70.9  84.2  104.  94.4  94.8  93.7  70.0  73.9  87.4
 6  81.7  81.1  73.9  93.0  72.5  85.7  105.  95.8  96.1  95.1  71.6  75.5  88.8
 7  81.4  80.8  74.0  91.9  72.7  85.0  103.  94.5  94.8  93.8  71.9  75.5  88.0
 8  81.1  80.5  73.9  91.4  72.6  84.7  103.  93.9  94.2  93.3  71.8  75.4  87.6
 9  80.7  80.1  73.9  90.4  72.6  84.0  101.  92.8  93.1  92.2  71.9  75.3  86.8
10  81.2  80.6  73.7  92.0  72.4  84.9  104.  94.6  94.9  93.9  71.5  75.2  88.0
   `261` `262` `263` `264` `265` `266` `267` `268` `269` `270` `271` `272` `273`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  87.1  93.7 100.   78.4  86.5  87.8  79.2  74.6  74.6  81.1  77.8  94.2  93.6
 2  86.7  93.1  99.6  78.1  86.0  87.3  78.9  74.4  74.4  80.7  77.5  93.7  93.0
 3  87.4  94.1 101.   78.5  86.8  88.1  79.3  74.6  74.6  81.2  77.9  94.7  94.0
 4  86.6  93.7 101.   77.3  85.9  87.4  78.1  73.2  73.2  80.2  76.6  94.3  93.6
 5  86.5  93.5 101.   77.1  85.8  87.2  78.0  73.1  73.1  80.0  76.5  94.1  93.4
 6  87.9  94.9 102.   78.7  87.2  88.6  79.6  74.7  74.7  81.5  78.1  95.5  94.8
 7  87.1  93.7 100.   78.5  86.5  87.8  79.3  74.8  74.8  81.2  77.9  94.2  93.6
 8  86.7  93.1  99.5  78.3  86.1  87.4  79.1  74.7  74.7  80.9  77.7  93.6  93.0
 9  86.0  92.0  98.1  78.0  85.4  86.6  78.8  74.6  74.6  80.5  77.5  92.5  91.9
10  87.1  93.7 100.   78.3  86.5  87.8  79.1  74.5  74.5  81.0  77.7  94.3  93.6
   `274` `275` `276` `277` `278` `279` `280` `281` `282` `283` `284` `285` `286`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  87.1  75.6  75.1  75.3  98.7  87.8  81.0  88.6  87.8  99.4  79.6  80.5  76.6
 2  86.7  75.3  74.9  75.0  98.0  87.4  80.7  88.1  87.3  98.7  79.3  80.1  76.3
 3  87.5  75.6  75.1  75.3  99.3  88.2  81.2  89.0  88.1 100.   79.8  80.6  76.6
 4  86.7  74.2  73.7  73.9  99.1  87.4  80.1  88.3  87.4  99.9  78.6  79.5  75.3
 5  86.5  74.1  73.6  73.8  98.8  87.3  79.9  88.1  87.2  99.7  78.5  79.3  75.2
 6  88.0  75.7  75.2  75.4 100.   88.7  81.5  89.5  88.6 101.   80.0  80.9  76.8
 7  87.2  75.7  75.3  75.4  98.6  87.9  81.1  88.6  87.8  99.4  79.7  80.5  76.7
 8  86.8  75.6  75.1  75.3  97.9  87.5  80.8  88.2  87.4  98.7  79.5  80.3  76.5
 9  86.0  75.4  75.0  75.1  96.6  86.7  80.4  87.4  86.6  97.3  79.1  79.9  76.3
10  87.1  75.4  75.0  75.1  98.8  87.9  80.9  88.6  87.8  99.6  79.5  80.4  76.5
   `287` `288` `289` `290` `291` `292` `293` `294` `295` `296` `297` `298` `299`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  81.6  78.8  74.8  77.1  73.1  75.8  72.9  80.3  74.4  75.8  74.6  72.9  76.1
 2  81.2  78.5  74.5  76.8  72.9  75.6  72.7  79.9  74.2  75.5  74.4  72.7  75.9
 3  81.8  78.9  74.8  77.1  73.1  75.9  72.9  80.4  74.4  75.8  74.6  72.9  76.2
 4  80.7  77.7  73.3  75.8  71.6  74.5  71.4  79.3  73.0  74.4  73.2  71.4  74.8
 5  80.5  77.5  73.2  75.7  71.5  74.4  71.3  79.1  72.9  74.3  73.1  71.3  74.7
 6  82.1  79.1  74.8  77.3  73.1  76.0  72.9  80.7  74.5  75.9  74.7  72.9  76.3
 7  81.7  78.9  74.9  77.2  73.3  76.0  73.1  80.4  74.6  75.9  74.8  73.1  76.3
 8  81.4  78.7  74.8  77.0  73.2  75.8  73.0  80.1  74.5  75.8  74.7  73.0  76.1
 9  80.9  78.3  74.7  76.8  73.2  75.7  73.0  79.7  74.4  75.6  74.6  73.0  75.9
10  81.5  78.7  74.6  76.9  73.0  75.7  72.8  80.2  74.3  75.6  74.5  72.8  76.0
   `300` `301` `302` `303` `304` `305` `306` `307` `308` `309` `310` `311` `312`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  80.0  79.9  79.8  97.7  76.8  76.9  89.4  91.2  84.8  88.6  85.0  79.6  90.7
 2  79.6  79.6  79.5  97.0  76.5  76.6  88.9  90.6  84.4  88.2  84.5  79.3  90.2
 3  80.1  80.0  80.0  98.2  76.8  76.9  89.8  91.6  85.1  89.0  85.2  79.8  91.1
 4  79.0  78.9  78.8  98.0  75.5  75.6  89.1  91.0  84.2  88.3  84.3  78.6  90.5
 5  78.8  78.7  78.7  97.8  75.4  75.5  88.9  90.8  84.0  88.1  84.2  78.5  90.3
 6  80.4  80.3  80.2  99.1  77.0  77.1  90.4  92.2  85.5  89.6  85.7  80.0  91.7
 7  80.1  80.0  79.9  97.6  76.9  77.0  89.4  91.2  84.9  88.7  85.0  79.7  90.7
 8  79.8  79.8  79.7  97.0  76.7  76.8  89.0  90.7  84.5  88.2  84.7  79.5  90.2
 9  79.4  79.4  79.3  95.7  76.5  76.6  88.1  89.7  83.9  87.4  84.0  79.1  89.3
10  79.9  79.8  79.7  97.8  76.7  76.8  89.4  91.2  84.8  88.7  84.9  79.5  90.7
   `313` `314` `315` `316` `317` `318` `319` `320` `321` `322` `323` `324` `325`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  80.3  91.7  86.8  97.6  83.7  77.3  86.8  78.7  73.2  77.6  82.1  71.4  95.5
 2  80.0  91.2  86.3  97.0  83.3  77.1  86.4  78.4  73.0  77.4  81.7  71.3  94.9
 3  80.5  92.1  87.1  98.2  83.9  77.4  87.1  78.8  73.2  77.7  82.3  71.3  96.0
 4  79.4  91.6  86.3  98.0  83.0  76.1  86.4  77.5  71.7  76.4  81.2  69.8  95.7
 5  79.2  91.4  86.1  97.7  82.8  76.0  86.2  77.4  71.6  76.3  81.1  69.7  95.4
 6  80.7  92.8  87.6  99.1  84.3  77.5  87.6  79.0  73.2  77.9  82.6  71.3  96.8
 7  80.4  91.7  86.8  97.6  83.8  77.4  86.9  78.8  73.4  77.8  82.2  71.6  95.5
 8  80.2  91.2  86.4  96.9  83.5  77.3  86.5  78.5  73.3  77.6  81.9  71.5  94.8
 9  79.8  90.2  85.7  95.6  82.9  77.0  85.7  78.2  73.3  77.3  81.4  71.6  93.7
10  80.3  91.7  86.8  97.7  83.7  77.2  86.8  78.6  73.0  77.5  82.0  71.2  95.6
   `326` `327` `328` `329` `330` `331` `332` `333` `334` `335` `336` `337` `338`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.8  87.7  85.2  84.5  93.2  92.0  75.8  82.1  95.7  76.9  96.0  86.0  78.8
 2  90.3  87.2  84.7  84.1  92.7  91.5  75.6  81.7  95.1  76.6  95.4  85.5  78.5
 3  91.2  88.0  85.4  84.8  93.7  92.5  75.9  82.3  96.2  76.9  96.6  86.3  78.9
 4  90.6  87.3  84.5  83.9  93.2  91.9  74.5  81.2  95.9  75.6  96.3  85.4  77.7
 5  90.4  87.1  84.4  83.7  93.0  91.7  74.4  81.1  95.6  75.5  96.0  85.3  77.5
 6  91.8  88.6  85.9  85.2  94.4  93.1  76.0  82.6  97.0  77.1  97.4  86.7  79.1
 7  90.8  87.7  85.2  84.6  93.2  92.0  76.0  82.2  95.6  77.0  96.0  86.0  78.9
 8  90.3  87.3  84.8  84.2  92.7  91.5  75.8  81.9  95.0  76.8  95.4  85.6  78.7
 9  89.4  86.5  84.2  83.6  91.6  90.5  75.6  81.4  93.8  76.6  94.2  85.0  78.3
10  90.8  87.7  85.1  84.5  93.3  92.1  75.7  82.0  95.8  76.8  96.1  86.0  78.7
   `339` `340` `341` `342` `343` `344` `345` `346` `347` `348` `349` `350` `351`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  72.5  74.9  76.0  77.6  82.3  79.6  88.2  78.6  85.2  98.8  81.5  79.0  80.7
 2  72.3  74.7  75.7  77.3  81.9  79.3  87.7  78.3  84.7  98.2  81.1  78.7  80.4
 3  72.5  74.9  76.0  77.6  82.5  79.7  88.6  78.7  85.4  99.5  81.6  79.1  80.9
 4  70.9  73.5  74.6  76.4  81.4  78.5  87.8  77.5  84.5  99.3  80.6  77.9  79.7
 5  70.8  73.4  74.5  76.2  81.3  78.4  87.7  77.3  84.4  99.1  80.4  77.7  79.6
 6  72.5  75.0  76.1  77.8  82.8  80.0  89.1  78.9  85.9 100.   81.9  79.3  81.1
 7  72.7  75.0  76.1  77.7  82.3  79.7  88.3  78.7  85.2  98.8  81.6  79.1  80.8
 8  72.6  74.9  75.9  77.5  82.1  79.5  87.8  78.5  84.8  98.1  81.3  78.8  80.5
 9  72.6  74.8  75.8  77.2  81.6  79.1  87.0  78.2  84.2  96.8  80.8  78.5  80.1
10  72.3  74.8  75.8  77.5  82.2  79.5  88.2  78.5  85.1  99.0  81.4  78.9  80.6
   `352` `353` `354` `355` `356` `357` `358` `359` `360` `361` `362` `363` `364`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  77.0  84.4  83.8  79.7  81.7  91.2  74.7  86.3  80.5  82.8  88.6  72.8  96.8
 2  76.7  84.0  83.4  79.4  81.4  90.6  74.5  85.8  80.1  82.4  88.1  72.6  96.2
 3  77.0  84.6  84.1  79.8  81.9  91.6  74.7  86.6  80.6  83.0  89.0  72.7  97.4
 4  75.7  83.7  83.1  78.7  80.8  91.0  73.3  85.7  79.5  82.0  88.3  71.2  97.1
 5  75.6  83.6  83.0  78.5  80.7  90.8  73.2  85.6  79.3  81.8  88.1  71.1  96.9
 6  77.2  85.1  84.5  80.1  82.2  92.2  74.8  87.0  80.9  83.3  89.5  72.7  98.3
 7  77.1  84.5  83.9  79.8  81.8  91.2  74.9  86.3  80.5  82.9  88.6  72.9  96.8
 8  76.9  84.1  83.6  79.6  81.5  90.7  74.7  85.9  80.3  82.5  88.2  72.8  96.2
 9  76.7  83.5  83.0  79.2  81.0  89.7  74.6  85.2  79.9  82.0  87.4  72.8  94.9
10  76.8  84.4  83.8  79.6  81.6  91.2  74.6  86.3  80.4  82.7  88.6  72.6  97.0
   `365` `366` `367` `368` `369` `370` `371` `372` `373` `374` `375` `376` `377`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  74.4  76.6  79.7  76.1  78.6  79.7  81.8  80.8  77.0  82.3  78.0  85.7  83.7
 2  74.2  76.4  79.4  75.9  78.3  79.4  81.4  80.4  76.7  81.9  77.7  85.3  83.3
 3  74.4  76.7  79.8  76.2  78.7  79.8  82.0  80.9  77.0  82.5  78.0  86.0  83.9
 4  72.9  75.4  78.6  74.8  77.5  78.6  80.9  79.8  75.7  81.4  76.8  85.1  83.0
 5  72.8  75.2  78.5  74.7  77.3  78.5  80.7  79.7  75.6  81.3  76.7  85.0  82.8
 6  74.4  76.8  80.1  76.3  78.9  80.1  82.3  81.2  77.2  82.8  78.2  86.4  84.3
 7  74.5  76.8  79.8  76.3  78.7  79.8  81.9  80.9  77.1  82.3  78.1  85.8  83.8
 8  74.4  76.6  79.5  76.1  78.5  79.5  81.6  80.6  76.9  82.1  77.9  85.4  83.5
 9  74.3  76.4  79.2  75.9  78.2  79.2  81.1  80.2  76.7  81.6  77.6  84.7  82.9
10  74.2  76.5  79.6  76.0  78.5  79.6  81.7  80.7  76.8  82.2  77.8  85.7  83.7
   `378` `379` `380` `381` `382` `383` `384` `385` `386` `387` `388` `389` `390`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  87.0  78.0  76.1  85.6  75.8  77.8  74.2  71.7  75.0  95.8  84.7  75.0  74.2
 2  86.6  77.7  75.9  85.2  75.5  77.5  73.9  71.5  74.8  95.2  84.3  74.8  74.0
 3  87.3  78.1  76.2  85.9  75.8  77.9  74.1  71.6  75.0  96.3  85.0  75.0  74.2
 4  86.6  76.9  74.8  85.0  74.4  76.6  72.7  70.1  73.6  96.0  84.1  73.6  72.7
 5  86.4  76.7  74.7  84.8  74.3  76.5  72.6  70.0  73.5  95.8  83.9  73.5  72.6
 6  87.8  78.3  76.3  86.3  75.9  78.1  74.2  71.6  75.1  97.1  85.4  75.1  74.2
 7  87.1  78.1  76.3  85.7  75.9  77.9  74.3  71.9  75.1  95.8  84.8  75.1  74.3
 8  86.7  77.9  76.1  85.3  75.7  77.7  74.2  71.8  75.0  95.1  84.4  75.0  74.2
 9  85.9  77.7  75.9  84.6  75.6  77.5  74.1  71.9  74.9  93.9  83.8  74.9  74.2
10  87.0  77.9  76.0  85.6  75.6  77.7  74.0  71.5  74.9  95.9  84.7  74.9  74.0
   `391` `392` `393` `394` `395` `396` `397` `398` `399` `400` `401` `402` `403`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  85.2  91.7  74.9  86.8  81.1  76.3  80.3  105. 101.   81.4  82.2  81.6  79.7
 2  84.8  91.1  74.7  86.4  80.8  76.0  79.9  104. 100.   81.1  81.9  81.2  79.3
 3  85.5  92.1  74.9  87.1  81.3  76.3  80.4  106. 102.   81.6  82.4  81.7  79.8
 4  84.6  91.6  73.5  86.4  80.2  75.0  79.3  106. 102.   80.5  81.4  80.7  78.6
 5  84.4  91.4  73.4  86.2  80.0  74.8  79.1  105. 101.   80.3  81.2  80.5  78.5
 6  85.9  92.8  75.0  87.6  81.5  76.4  80.7  107. 103.   81.9  82.7  82.0  80.0
 7  85.3  91.7  75.0  86.9  81.2  76.4  80.4  105. 101.   81.5  82.3  81.6  79.8
 8  84.9  91.2  74.9  86.5  80.9  76.2  80.1  104. 100.   81.2  82.0  81.4  79.5
 9  84.3  90.2  74.8  85.7  80.5  76.1  79.7  102.  98.7  80.8  81.5  80.9  79.2
10  85.2  91.7  74.8  86.8  81.0  76.1  80.2  105. 101.   81.3  82.2  81.5  79.6
   `404` `405` `406` `407` `408` `409` `410` `411` `412` `413` `414` `415` `416`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 102.   77.5  76.3  87.5  86.5  92.4  79.6  90.4  83.6  91.3  92.5  96.4  78.5
 2 101.   77.2  76.0  87.0  86.1  91.8  79.3  89.9  83.2  90.8  92.0  95.8  78.2
 3 103.   77.5  76.3  87.8  86.8  92.8  79.7  90.8  83.8  91.8  93.0  97.0  78.6
 4 103.   76.2  75.0  87.0  86.0  92.3  78.5  90.2  82.9  91.2  92.5  96.7  77.3
 5 102.   76.1  74.8  86.8  85.9  92.1  78.4  90.0  82.7  91.0  92.3  96.4  77.2
 6 104.   77.7  76.4  88.3  87.3  93.5  80.0  91.4  84.2  92.4  93.7  97.8  78.8
 7 102.   77.6  76.4  87.5  86.6  92.4  79.7  90.4  83.7  91.4  92.6  96.4  78.6
 8 101.   77.4  76.2  87.1  86.2  91.8  79.5  89.9  83.3  90.8  92.0  95.8  78.4
 9  99.6  77.1  76.1  86.3  85.5  90.8  79.1  89.0  82.8  89.9  91.0  94.5  78.1
10 102.   77.3  76.1  87.5  86.5  92.4  79.5  90.4  83.5  91.4  92.6  96.5  78.4
   `417` `418` `419` `420` `421` `422` `423` `424` `425` `426` `427` `428` `429`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  84.5  80.6  80.0  71.1  81.6  84.3  84.8  105.  73.4  103. 101.   74.8  71.4
 2  84.1  80.3  79.7  70.9  81.2  83.9  84.4  104.  73.2  102. 100.   74.5  71.3
 3  84.8  80.7  80.2  71.0  81.7  84.5  85.1  106.  73.4  104. 102.   74.8  71.3
 4  83.9  79.6  79.0  69.3  80.7  83.6  84.2  106.  71.9  104. 102.   73.3  69.8
 5  83.7  79.5  78.9  69.3  80.5  83.4  84.0  106.  71.8  103. 101.   73.2  69.7
 6  85.2  81.0  80.4  70.9  82.0  84.9  85.5  107.  73.4  105. 103.   74.8  71.3
 7  84.6  80.7  80.1  71.2  81.6  84.4  84.9  105.  73.6  103. 101.   74.9  71.6
 8  84.2  80.4  79.9  71.2  81.4  84.0  84.5  104.  73.5  102. 100.   74.8  71.5
 9  83.6  80.0  79.5  71.3  80.9  83.4  83.9  103.  73.5  100.  98.7  74.7  71.6
10  84.5  80.5  79.9  70.9  81.5  84.2  84.8  105.  73.3  103. 101.   74.6  71.2
   `430` `431` `432` `433` `434`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  77.4  82.2  83.3  84.5  81.2
 2  77.1  81.9  83.0  84.1  80.8
 3  77.5  82.4  83.6  84.8  81.3
 4  76.2  81.4  82.6  83.9  80.3
 5  76.1  81.2  82.4  83.7  80.1
 6  77.6  82.7  83.9  85.2  81.6
 7  77.5  82.3  83.4  84.6  81.3
 8  77.3  82.0  83.1  84.2  81.0
 9  77.1  81.5  82.5  83.6  80.6
10  77.3  82.2  83.3  84.5  81.1
# â„¹ 3,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare summaries of predicted iq scores vs observed iq scores for all observations</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if model is a good fit for the data, these summaries should be very similar!</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>iter1 <span class="ot">&lt;-</span> predictions[<span class="dv">1</span>,] <span class="co"># first iteration</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>iter2 <span class="ot">&lt;-</span> predictions[<span class="dv">2</span>,] <span class="co"># second iteration</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kidiq<span class="sc">$</span>kid_score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   20.0    74.0    90.0    86.8   102.0   144.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iter1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   69.2    79.7    85.2    86.4    92.5   109.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iter2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   69.0    79.3    84.7    86.0    92.0   108.7 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare summaries of predicted iq scores vs observed iq scores for single observations</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if model is a good fit for the data, these summaries should be similar!</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>kidiq<span class="sc">$</span>kid_score[<span class="dv">24</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predictions[, <span class="dv">24</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   83.7    86.1    86.7    86.7    87.4    89.7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>kidiq<span class="sc">$</span>kid_score[<span class="dv">185</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predictions[, <span class="dv">185</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   83.2    85.6    86.2    86.2    86.8    89.2 </code></pre>
</div>
</div>
<p>Model fit with posterior predictive model checks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>r2_posterior <span class="ot">&lt;-</span> <span class="fu">bayes_R2</span>(stan_model)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(r2_posterior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0978  0.1782  0.2002  0.2007  0.2230  0.3058 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(r2_posterior, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="co"># credible interval</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  2.5%  97.5% 
0.1405 0.2628 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span> r2_posterior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Density overlay:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(stan_model, <span class="st">"dens_overlay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vp$just: partial match of 'just' to 'justification'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(stan_model, <span class="st">"stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vp$just: partial match of 'just' to 'justification'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(stan_model, <span class="st">"stat_2d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in vp$just: partial match of 'just' to 'justification'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bayesian-model-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-model-comparisons">Bayesian model comparisons</h3>
<p><code>loo</code> package = leave-one-out (approximated cross-validation)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(stan_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 4000 by 434 log-likelihood matrix.

         Estimate   SE
elpd_loo  -1878.6 14.5
p_loo         2.9  0.3
looic      3757.2 29.0
------
MCSE of elpd_loo is 0.0.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.9, 1.1]).

All Pareto k estimates are good (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>model_1pred <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">data =</span> kidiq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.5e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.15 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.021 seconds (Warm-up)
Chain 1:                0.041 seconds (Sampling)
Chain 1:                0.062 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 5e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.025 seconds (Warm-up)
Chain 2:                0.044 seconds (Sampling)
Chain 2:                0.069 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 4e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.026 seconds (Warm-up)
Chain 3:                0.045 seconds (Sampling)
Chain 3:                0.071 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 4e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.025 seconds (Warm-up)
Chain 4:                0.047 seconds (Sampling)
Chain 4:                0.072 seconds (Total)
Chain 4: </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>model_2pred <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(kid_score <span class="sc">~</span> mom_iq <span class="sc">+</span> mom_hs, <span class="at">data =</span> kidiq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
Chain 1: 
Chain 1: Gradient evaluation took 1.1e-05 seconds
Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
Chain 1: Adjust your expectations accordingly!
Chain 1: 
Chain 1: 
Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 1: 
Chain 1:  Elapsed Time: 0.029 seconds (Warm-up)
Chain 1:                0.047 seconds (Sampling)
Chain 1:                0.076 seconds (Total)
Chain 1: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
Chain 2: 
Chain 2: Gradient evaluation took 5e-06 seconds
Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
Chain 2: Adjust your expectations accordingly!
Chain 2: 
Chain 2: 
Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 2: 
Chain 2:  Elapsed Time: 0.03 seconds (Warm-up)
Chain 2:                0.048 seconds (Sampling)
Chain 2:                0.078 seconds (Total)
Chain 2: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 3).
Chain 3: 
Chain 3: Gradient evaluation took 4e-06 seconds
Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.04 seconds.
Chain 3: Adjust your expectations accordingly!
Chain 3: 
Chain 3: 
Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 3: 
Chain 3:  Elapsed Time: 0.023 seconds (Warm-up)
Chain 3:                0.043 seconds (Sampling)
Chain 3:                0.066 seconds (Total)
Chain 3: 

SAMPLING FOR MODEL 'continuous' NOW (CHAIN 4).
Chain 4: 
Chain 4: Gradient evaluation took 3e-06 seconds
Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.03 seconds.
Chain 4: Adjust your expectations accordingly!
Chain 4: 
Chain 4: 
Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
Chain 4: 
Chain 4:  Elapsed Time: 0.026 seconds (Warm-up)
Chain 4:                0.047 seconds (Sampling)
Chain 4:                0.073 seconds (Total)
Chain 4: </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>loo_1pred <span class="ot">&lt;-</span> <span class="fu">loo</span>(model_1pred)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>loo_2pred <span class="ot">&lt;-</span> <span class="fu">loo</span>(model_2pred)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(loo_1pred, loo_2pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            elpd_diff se_diff
model_2pred  0.0       0.0   
model_1pred -2.5       2.8   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">list</span>(<span class="st">"1pred"</span> <span class="ot">=</span> model_1pred, <span class="st">"2pred"</span> <span class="ot">=</span> model_2pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1pred</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;2pred</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">25.625</td>
<td style="text-align: center;">25.903</td>
</tr>
<tr class="even">
<td style="text-align: left;">mom_iq</td>
<td style="text-align: center;">0.613</td>
<td style="text-align: center;">0.562</td>
</tr>
<tr class="odd">
<td style="text-align: left; box-shadow: 0px 1.5px;">mom_hs</td>
<td style="text-align: center; box-shadow: 0px 1.5px;"></td>
<td style="text-align: center; box-shadow: 0px 1.5px;">5.973</td>
</tr>
<tr class="even">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">434</td>
<td style="text-align: center;">434</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2</td>
<td style="text-align: center;">0.202</td>
<td style="text-align: center;">0.214</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.194</td>
<td style="text-align: center;">0.204</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: center;">âˆ’1876.341</td>
<td style="text-align: center;">âˆ’1872.723</td>
</tr>
<tr class="even">
<td style="text-align: left;">ELPD</td>
<td style="text-align: center;">âˆ’1878.6</td>
<td style="text-align: center;">âˆ’1876.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ELPD s.e.</td>
<td style="text-align: center;">14.5</td>
<td style="text-align: center;">14.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">LOOIC</td>
<td style="text-align: center;">3757.1</td>
<td style="text-align: center;">3752.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOOIC s.e.</td>
<td style="text-align: center;">29.0</td>
<td style="text-align: center;">28.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">WAIC</td>
<td style="text-align: center;">3757.1</td>
<td style="text-align: center;">3752.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">18.22</td>
<td style="text-align: center;">18.07</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="presenting-and-using-a-bayesian-regression" class="level2">
<h2 class="anchored" data-anchor-id="presenting-and-using-a-bayesian-regression">Presenting and Using a Bayesian Regression</h2>
<p>In this chapter, weâ€™ll learn how to use the estimated model to create visualizations of your model and make predictions for new data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>tidy_coef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(stan_model)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>model_intercept <span class="ot">&lt;-</span> tidy_coef<span class="sc">$</span>estimate[[<span class="dv">1</span>]]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>model_slope <span class="ot">&lt;-</span> tidy_coef<span class="sc">$</span>estimate[[<span class="dv">2</span>]]</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">data =</span> kidiq) <span class="sc">|&gt;</span> <span class="fu">gf_abline</span>(<span class="at">intercept =</span> model_intercept, <span class="at">slope =</span> model_slope, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting uncertainty (one line for each iteration)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(stan_model, <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, mom_iq)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>draws</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 Ã— 5
   .chain .iteration .draw `(Intercept)` mom_iq
    &lt;int&gt;      &lt;int&gt; &lt;int&gt;         &lt;dbl&gt;  &lt;dbl&gt;
 1      1          1     1          26.9  0.595
 2      1          2     2          27.5  0.585
 3      1          3     3          25.7  0.610
 4      1          4     4          21.7  0.641
 5      1          5     5          21.9  0.638
 6      1          6     6          24.0  0.632
 7      1          7     7          27.3  0.591
 8      1          8     8          28.4  0.577
 9      1          9     9          30.7  0.546
10      1         10    10          26.1  0.602
# â„¹ 3,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(kid_score <span class="sc">~</span> mom_iq, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">data =</span> kidiq) <span class="sc">|&gt;</span> <span class="fu">gf_abline</span>(<span class="at">intercept =</span> <span class="sc">~</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, <span class="at">slope =</span> <span class="sc">~</span>mom_iq, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">data =</span> draws) <span class="sc">|&gt;</span> <span class="fu">gf_abline</span>(<span class="at">intercept =</span> model_intercept, <span class="at">slope =</span> model_slope, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
â„¹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="making-predictions" class="level3">
<h3 class="anchored" data-anchor-id="making-predictions">Making predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(model_2pred)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 Ã— 434
     `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`  `10`  `11`  `12`  `13`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  98.1 112.  105.   97.6  91.3 124.   98.9 110.   54.4 101.   74.7 107.   74.4
 2  84.5  90.9 113.   97.1  82.2  69.6  99.3 117.   55.8  88.0  90.3  79.0 111. 
 3 111.  103.   89.3 100.   88.3 104.  110.   89.0  97.3 101.   83.9  90.2 111. 
 4 119.   74.4  78.4  99.2  80.8 103.  113.  109.   72.7  68.7 111.   91.1  81.3
 5  89.9  66.7  47.8  85.0  81.7 103.  105.  107.   56.6 104.   76.1  92.3  88.0
 6  91.9 102.   87.4  78.4  83.7  60.6 124.  116.   55.7 124.   97.6  81.7  44.1
 7  67.4  47.4 137.  101.   77.8  71.4  78.6 106.   52.1  72.2  76.6  80.3 130. 
 8 116.   78.9  77.8  90.1  57.9  93.5 115.  125.   90.4  76.2  98.5  64.1  69.6
 9  69.7  96.8 100.  128.   98.1  76.4 123.  108.  103.   92.1  59.5  61.7  68.0
10 136.   74.3 104.   97.2  53.1  75.6 116.   92.0  63.2  61.5  96.8 111.   96.9
    `14`  `15`  `16`  `17`  `18`  `19`  `20`  `21`  `22`  `23`  `24`  `25`  `26`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 106.   59.1 107.   98.0 101.  109.   84.1  90.3  86.0  75.7  63.4  72.8  82.3
 2 125.   68.3 127.   88.0  70.3 118.   59.5  74.8 109.   63.3 124.   89.7 146. 
 3 109.   95.0  83.9  89.8  85.4 114.   67.9  67.5  90.7 103.  106.  133.  114. 
 4 110.   96.5 123.  117.   95.3  94.7  86.9 102.  130.  105.   79.2  95.9  97.5
 5 108.  124.   92.2 102.   76.1  93.8  97.9  95.4  97.7  54.6  75.9  68.2  89.7
 6  72.1  78.4 113.   85.8  95.9  59.7  62.2 112.   63.4 105.  108.   92.1 101. 
 7  90.7  74.7 101.  105.   74.3 129.   53.8  86.4  84.1 122.  106.  127.   83.9
 8  94.8  72.6 136.  121.   85.8 112.   70.5 104.   63.0  50.2  76.3 116.  125. 
 9 116.   89.7 103.  135.   86.0 116.   76.4  99.5  69.3  74.9  90.6  77.9  90.7
10  84.4  72.3  71.0 104.   89.0 139.   81.5  78.4 118.   80.9  97.4  90.7 125. 
    `27`  `28`  `29`  `30`  `31`  `32`  `33`  `34`  `35`  `36`  `37`  `38`  `39`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  91.7  76.6  94.3  96.2  80.3  63.0  93.7  95.1  71.6  50.8 110.  119.   61.8
 2 110.   62.7  97.5  55.0  98.5  84.5 120.   92.6  78.7  68.5 108.  107.   62.7
 3  87.8  89.2  66.7  79.4  92.7  97.7  86.1  76.0  53.7 105.   88.7  92.3  47.2
 4  75.3  84.0  54.2 103.   76.5  55.0 121.   95.4  75.9  91.5  71.9  90.8  55.9
 5  79.7  95.2  81.3 148.   55.9  97.2  90.3  99.0 101.   71.4  87.4  96.5 101. 
 6  58.6  97.3 104.  101.   89.4 109.  115.  103.   94.0 107.   69.3  82.5  62.6
 7  91.2  83.4  46.8 110.  125.  105.   97.7  89.2 120.   83.4  69.5 116.   68.1
 8  92.4  54.3  69.1  83.0  80.4 131.   83.2  65.3 106.   68.0  50.4  84.0  80.1
 9  86.0  71.5  57.3 111.   74.6  97.5  99.8 105.   87.0  64.4  76.7 113.   82.5
10  82.5  94.9  73.1 117.   92.8  76.5 106.   99.8  53.1  87.3  80.8  77.7  73.4
    `40`  `41`  `42`  `43`  `44`  `45`  `46`  `47`  `48`  `49`  `50`  `51`  `52`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  99.4 119.  118.   96.3 109.   59.7  97.8  53.9 122.  111.   68.3  61.3 126. 
 2 102.   84.2 110.  107.  121.   70.8 104.   60.0  87.6  92.2 117.   99.3  99.9
 3  71.7  75.9 112.   81.5 112.   76.4 109.   91.0 130.  111.   67.9  98.2 113. 
 4  59.5  89.4 101.   73.6  85.0  94.2 118.   50.6  81.9 121.   70.6  73.6  92.7
 5  80.6  85.2 120.   54.0 114.   51.0  96.3  50.5  91.1  91.6  65.5 103.   85.9
 6  92.0  97.2  92.3  52.3  99.9  87.0 101.   69.2  94.5  88.7 114.   69.0  90.9
 7  57.6  70.6  68.0  76.3 103.   56.6 102.   38.2 124.  135.   88.9 104.  102. 
 8  86.7 129.  134.   85.0  85.2  93.6 102.   98.1 120.  112.  114.   85.8  95.7
 9 105.   81.8  98.6  71.5  99.6  69.0 109.   56.7  95.3 138.   71.8 111.   96.4
10  89.8  95.8  62.9  65.6  65.3  81.2  61.4  79.1  97.9 110.   84.0  79.5 113. 
    `53`  `54`  `55`  `56`  `57`  `58`  `59`  `60`  `61`  `62`  `63`  `64`  `65`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  72.7  90.6  95.7  58.6  73.8  56.9  52.4  72.3 112.  105.   94.8 102.   86.5
 2 111.   80.7  86.3  68.3  64.4  78.3  47.1 135.  120.  109.   89.5  88.8 138. 
 3  85.8  72.2  98.8  65.2 100.  116.   97.5  93.9  95.7 116.   66.9  84.4  87.0
 4 113.   94.3  75.5  62.4  44.4  77.4 112.   90.4  64.8  98.6  92.7 104.  101. 
 5  46.4  87.7 113.   98.6  60.0  56.9  87.8  75.1  81.6 122.   86.6  71.6  54.7
 6  68.1  90.8  98.3  77.0  62.0  71.0  74.9 121.  100.  109.   68.2 101.  110. 
 7  63.5  60.6  58.0  77.1  50.7  92.0  87.5 100.  130.   66.5  89.0 100.  105. 
 8  82.9  65.1  83.8  67.6  87.3  89.2  54.0  81.8 102.   87.5  86.4  77.2  86.1
 9  80.9  93.4  67.1  52.1  78.1  82.2  73.5 113.   82.0  69.5  75.1  83.2 118. 
10 103.   65.9 121.  102.   85.5  68.8  71.8  71.3  78.6 104.   80.4  84.5  74.5
    `66`  `67`  `68`  `69`  `70`  `71`  `72`  `73`  `74`  `75`  `76`  `77`  `78`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.3  87.9  51.3  66.0  58.4 109.   71.6 120.   96.6  70.9  59.7  85.0  42.0
 2  65.2  74.6  89.1  89.5 113.   84.9 122.   93.7  67.0  53.2  87.0 114.   93.6
 3  78.3  62.1  82.8 119.   66.1  86.2  86.8 139.  112.   91.8  83.6  83.8  46.6
 4  97.0  73.6  80.9  71.0  40.4  58.8  88.3  84.1  72.1  97.9 108.  122.   75.9
 5  72.3  60.4 106.   59.0  97.5  59.0  59.5  99.0 107.   64.6 101.   96.6  83.4
 6  91.7 111.   75.0 110.   77.1 126.  122.  115.  124.   50.8  74.9  90.7  95.4
 7  96.3  91.0  59.2  33.2  72.8  92.4 121.  119.   89.8  61.7  58.3 134.   53.4
 8  84.8 123.  109.   74.1  57.9  90.9  83.3 102.   90.9  74.0  66.7  98.7  40.3
 9  78.2  77.4  84.4 110.   69.1  63.9 124.   91.4  88.4  71.7  92.6 120.  101. 
10 122.   85.1  49.0  66.2  66.8  76.2  64.1  80.9 106.   75.4  67.5  79.6  76.7
    `79`  `80`  `81`  `82`  `83`  `84`  `85`  `86`  `87`  `88`  `89`  `90`  `91`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 101.   52.3  48.4  57.6  86.0 118.   98.5 106.   72.5  73.4 136.  104.   99.7
 2  77.0  74.7  69.4 104.  124.   88.2  82.8  70.4  88.2 119.  106.  107.  121. 
 3  92.9  39.4  77.5 127.   87.6  90.1  84.5  89.5 107.   94.3 128.  104.  119. 
 4 105.   86.7  75.5  66.9  60.9  88.8  20.2  53.9  89.0 139.  114.  131.  102. 
 5 131.  109.  101.  103.   91.4 102.   72.3 112.   57.1 132.   99.9 106.   97.1
 6 110.   62.0  74.1  75.8 102.   97.2  80.1  84.0  90.2 111.   99.7 115.  102. 
 7 117.   63.0 102.  119.  108.   80.4  76.7  72.3  47.3 130.  109.  132.  113. 
 8 116.   40.5  74.2 105.   58.4 123.   79.3 105.   53.1  75.2 125.   99.6 122. 
 9  74.7  85.4  89.8  82.5  78.0 107.   89.1 113.   85.4  79.8 133.  137.  121. 
10  55.8  69.5  70.2  91.4 129.  126.   89.3 103.   87.9  87.0 146.  114.  128. 
    `92`  `93`  `94`  `95`  `96`  `97`  `98`  `99` `100` `101` `102` `103` `104`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 118.   99.8 104.   97.6 103.   51.2  46.1  73.6 106.  125.   81.3 132.  107. 
 2  88.2  77.4  95.5 128.   54.9  83.6  89.9 106.   69.0 137.   75.5  81.1 102. 
 3  85.8  72.8  98.5 109.   62.5  60.7  56.0  75.7  68.9 106.   91.7  92.7  88.2
 4  98.2  97.9 129.  101.   66.1  71.9  85.5  71.1  56.6  94.6 135.  101.   50.2
 5  94.1  92.6  85.2  97.8  71.5  79.0  67.9  84.5  42.5  69.7  97.0  79.1  45.6
 6 104.  108.  104.   88.1  68.7  65.3  66.4  86.6  96.9  93.6  78.1  68.3  37.4
 7 104.  122.  130.   98.4  94.3 110.  110.   99.5  74.7 108.   87.2  75.5  68.6
 8  62.3  99.4 119.  122.   86.4  86.3  87.3  73.0  88.6  90.1 118.   85.7  64.3
 9 104.   88.7 118.   74.1  93.1  68.0  78.1  81.9  71.3  59.5  53.8  80.4  65.7
10  70.1 104.  108.  124.  106.   88.1  90.0  88.0  35.1  48.1 112.   84.7  76.9
   `105` `106` `107` `108` `109` `110` `111` `112` `113` `114` `115` `116` `117`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  97.2  98.9  82.7 110.  118.   96.2  92.5  93.0 111.   53.9  89.3  74.6  69.8
 2  86.6  83.4  57.6 112.   73.2  89.5  59.3  99.1  61.6  99.3  87.1  61.6  74.7
 3 100.  100.   84.9 111.   88.5  73.3  69.6 105.   90.4  92.8  67.0 105.   81.0
 4 100.  129.   67.4 101.   89.4  88.0  59.6  96.8 104.   88.4  76.4 102.   91.0
 5  67.6  86.5  63.2  79.3  93.4  90.9  71.3  96.7 103.   62.9  55.5  84.7  57.6
 6  87.5 116.   63.0  80.8 107.  109.   81.2 101.   70.2  89.8  97.1 101.   89.1
 7  79.7  82.3 124.   93.2 101.  121.   69.7  83.0  96.2  51.0  96.9  71.8  55.4
 8  91.8  93.7  83.8  85.5  96.5  92.0  80.0  80.1  91.1  61.6  71.0  81.6  76.3
 9  80.5 107.   89.2 100.  109.  125.   62.8  60.6 118.   79.8 115.  110.   95.0
10  42.2  92.4  91.9 114.   95.9 106.   42.5  86.6  91.2 100.   78.6 105.   88.3
   `118` `119` `120` `121` `122` `123` `124` `125` `126` `127` `128` `129` `130`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 101.   68.6  84.3  94.0 131.   88.2  79.9 108.  107.   85.2  95.6 106.   61.1
 2 113.   91.0 101.   84.4 118.  108.   90.5  95.2 115.  106.   47.7  69.5  81.8
 3 123.   99.4  87.1  87.0 105.  102.  125.   62.6 107.  101.  101.  116.   86.4
 4  95.6  67.3  90.0  95.5 127.   91.8  95.7  98.8  47.0  89.2  83.0  78.6  73.2
 5  87.7  78.3  79.6  59.0  98.3  79.2 103.   87.9 114.   67.9  97.4  64.5  68.8
 6 123.   81.4  74.1  80.0  90.7  94.5  87.7  60.9 101.   70.3  64.8  58.0  54.5
 7  76.0  45.5  91.3  84.8 105.   76.5 113.  109.   85.1 103.   85.1 118.   50.0
 8 119.   79.6  95.3 114.  112.   82.0  91.0 112.  113.  101.  101.   82.0  77.7
 9 117.   79.0 101.  105.  122.  104.   92.5  94.4  51.5  79.8  94.0  84.5 102. 
10 119.  103.   83.3  94.7 106.  103.  103.  111.   85.0  84.1  76.8  82.7  82.3
   `131` `132` `133` `134` `135` `136` `137` `138` `139` `140` `141` `142` `143`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  59.6  85.9 120.   80.2  80.2  92.5  73.0 115.   85.8  92.6 141.   83.6 136. 
 2  78.8  63.9 107.  110.   87.7 117.  109.   89.9 121.  107.   78.4 110.  149. 
 3  94.6  82.2  85.2  98.5  70.5 106.   74.5  87.8 131.   61.7  98.2 104.   98.9
 4  94.4  68.1 136.  107.   68.4 132.   44.8  54.5  61.8  49.6  82.9  91.6 123. 
 5  83.8 111.  103.   97.4 100.  111.   59.6  45.1 101.  122.   99.3 158.   89.2
 6  55.8  82.2 101.   99.6  88.2  89.7  54.2  60.6 105.  127.  121.   76.3 158. 
 7  74.1  99.5  69.5 122.   92.2 125.   85.9  80.4 106.   89.5 112.   86.0 109. 
 8  74.3  70.5  86.4  84.2 122.  143.   50.2  85.9 123.  103.   93.3 119.  121. 
 9  94.4  62.3 108.   98.3  84.7  75.0  82.8  91.0  96.4  85.7 102.  114.  108. 
10  63.6 118.  117.  126.   59.4  87.1 102.  128.  127.   81.8 115.  140.  126. 
   `144` `145` `146` `147` `148` `149` `150` `151` `152` `153` `154` `155` `156`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  81.9 105.   70.6  79.3  91.4  79.0 115.   95.0  88.9  80.8 108.   88.6  88.8
 2  92.5 109.  111.  121.   89.3  76.6 123.   92.6 106.  131.   79.6  92.6  87.5
 3 116.   94.3  76.3  88.8  61.6  67.6  73.9  74.0 139.  107.  107.   63.5  77.8
 4  93.2 150.  104.  101.   78.0  66.7  94.0  81.8 101.  107.   87.8  83.0  66.1
 5  88.0  55.5  65.3  72.1 102.   92.5  86.4  61.4  87.4 109.   60.8  95.4 119. 
 6  77.8 125.   94.5 125.   65.4 109.  126.  123.   74.3  94.7  95.4  96.4  77.9
 7 118.  113.   76.2 106.   68.3  93.2  97.1  87.3 106.  130.  135.   81.0  69.1
 8  59.3 111.   98.1 109.   75.2 107.   72.0 108.  134.   98.8 115.   83.9  65.3
 9  91.9  91.4  97.3  70.5 105.   85.7  94.0 107.  126.   99.3 120.   93.0  61.4
10 124.  134.  115.   74.2 103.   85.3 144.  141.  102.   88.0  95.1  75.9  99.8
   `157` `158` `159` `160` `161` `162` `163` `164` `165` `166` `167` `168` `169`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 105.   81.2  74.7 101.   81.3  84.5 106.  149.   95.9  91.4  75.7 131.  101. 
 2  66.2 108.   99.5  71.3  79.5  73.6 109.  117.  126.   86.4  86.8 111.   86.8
 3 122.   77.8 109.   80.3  86.4  58.5  89.2  99.8  94.3  87.5 120.   89.8 137. 
 4  89.7  78.3  53.6  62.4  86.5  99.8  77.9 101.   98.0  78.9  83.5 106.   75.0
 5  75.8  91.7  66.5  72.9  53.0  82.9 130.   90.5 103.   62.5  95.8  81.1  71.1
 6 104.  102.   98.3  79.6  74.7  77.5 122.  116.   79.0  61.4 107.  118.   69.3
 7 130.  122.   97.4 102.   67.7  95.8  94.0  94.9  87.9  72.8 128.  119.   65.1
 8 108.   92.6  89.9  94.0  57.8  77.9 106.  127.  106.   55.3  78.6 104.   99.7
 9 102.  120.   94.8  74.0 101.   71.0 102.  109.  115.  127.   75.3  93.3 108. 
10 127.   89.1  93.8  96.0  80.8  73.5  90.1  90.2  71.0  88.3  91.6  85.6  68.6
   `170` `171` `172` `173` `174` `175` `176` `177` `178` `179` `180` `181` `182`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 101.  104.  104.  103.  107.   54.9  77.9 107.  102.   61.7 116.   68.7  89.2
 2  98.9 113.  117.  127.   64.8  16.6 103.   91.7  82.7  98.5 100.   99.3  75.7
 3  73.7  84.8 101.   97.5 107.   88.3  80.8 107.  114.   81.0  83.5  90.4  69.7
 4  87.3  91.0  99.6  87.3  52.4  59.5  50.1 100.  101.   85.5  71.3  84.0  88.6
 5  66.8 138.   86.7  86.6  65.1  35.4  98.3 116.   98.2  63.0  98.0  87.6  65.4
 6  76.3 105.   81.1 129.   59.1  93.4  65.0  88.6  79.8  58.0  88.3  79.8  67.2
 7 103.   76.6 100.  125.   88.5  78.5  72.4  80.7  70.3  80.9  97.2  78.3  51.8
 8  76.2  81.9  83.1  84.0  87.3  92.2  79.0  99.7  87.1  78.1 121.   82.9  78.0
 9 112.  105.   78.4  73.7 103.   61.2  63.0  93.2  93.4 105.   91.1  92.8  60.6
10  86.7 116.  104.  101.  101.   87.1  88.2  86.3  77.9  92.0  98.8  87.4  73.3
   `183` `184` `185` `186` `187` `188` `189` `190` `191` `192` `193` `194` `195`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  88.6 104.   81.9 109.  121.   96.6 102.  102.   72.5  66.0 111.   62.7 116. 
 2  98.9 108.   53.0  56.4  81.4  84.1  76.4  78.4  71.4  88.9  92.0  74.7  81.9
 3  74.5 102.   44.2  88.5 112.   84.6 109.   94.4  67.4  52.3  81.0  91.2 103. 
 4  92.6  63.6  92.0  95.3 111.   85.1  56.1  92.2 105.   93.5 106.   99.2  79.1
 5  49.5  88.0  86.1  92.0  96.3 112.   75.8  77.5  95.8  70.2 113.   72.9  86.7
 6  75.9 102.   83.8  96.2  65.3 105.   62.3 102.   60.6  66.3  84.9 111.  103. 
 7  77.8 111.   70.3  94.9 111.   91.3  81.5  93.1  39.9  66.0  55.3  71.2  71.2
 8  83.0  78.9  77.1  72.3  99.6  96.2  70.2  76.3  95.1  85.0 103.   88.5  60.9
 9  52.2  72.6  94.9  94.8 111.   99.0  71.7  80.6  84.0  75.0  76.4  86.0 139. 
10 101.  107.  116.   92.1  87.5  81.4  71.9  98.2  82.6  67.6  61.1  69.9  52.2
   `196` `197` `198` `199` `200` `201` `202` `203` `204` `205` `206` `207` `208`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  55.6 118.  103.   84.4 109.   97.4 119.  107.  116.  110.   67.1  42.9 117. 
 2  72.6  97.9  94.9  75.7  70.7  83.3  64.5 100.   80.2 101.   56.3 106.   79.7
 3 120.  113.  102.   59.9  91.0  88.9 102.  114.  110.  103.   67.9  83.0 128. 
 4  58.1  91.3 129.   61.8 112.   65.9 117.  111.   82.1  80.5  73.3  57.5 104. 
 5  74.4  85.0  59.7  80.3  97.5  81.7  99.1 102.   63.9  84.4 102.   61.9  86.3
 6  63.2  80.0  85.9  82.3  86.1  51.8  63.0  76.9 118.   98.5  78.3  80.3  91.4
 7  74.4  94.9 112.   96.6 115.   99.7  85.7 131.   90.0  96.3  34.2  66.1 112. 
 8 108.   93.3  94.3  80.6  86.0  82.2 133.  134.   78.0  84.3  75.0  61.4 101. 
 9  61.7  88.6  96.2 110.   80.1  96.9  70.9  79.2  82.0  92.6  49.0 107.   84.6
10  74.6  85.6 121.   78.5 128.   97.0  72.7 100.   96.2 118.   90.8  80.6  86.9
   `209` `210` `211` `212` `213` `214` `215` `216` `217` `218` `219` `220` `221`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 125.   79.5  62.0  90.5  53.2  89.7 126.   77.4  47.4 101.  104.   99.3 101. 
 2 113.   57.5  77.0  96.2 136.   80.0 151.  139.   65.8  88.8  96.8 117.   82.6
 3  94.3  89.0 105.  119.   84.3  85.1 119.   83.9 101.   78.4  87.0  63.5  98.9
 4 105.   75.1  76.6  94.3  76.8 107.  105.   86.7  93.2  75.7 116.   88.9  74.6
 5 118.   72.0 117.   90.7  84.7  79.4 126.  107.   65.0  62.4 112.  113.   81.8
 6  86.2  65.3 111.   91.3  56.9  65.2 117.  117.  107.   37.7  99.6 111.  113. 
 7 104.   79.2  92.1 103.   90.6 102.   89.0 112.   84.8  73.4 152.  114.   91.6
 8 102.  115.   86.7  97.5  86.7 121.  132.  104.   72.1  69.5 109.  123.  101. 
 9  99.1 115.   52.5  71.4 112.   96.1 111.  116.   98.6  98.3  53.0 131.  103. 
10  70.1  95.6  77.9  82.9  86.9  65.1  91.1  90.4  56.2  62.4 114.  111.   95.2
   `222` `223` `224` `225` `226` `227` `228` `229` `230` `231` `232` `233` `234`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  84.1  81.8 109.  103.  116.  117.   85.2 101.   66.6  85.4  94.8  83.2  86.6
 2  81.3 107.  102.   95.0  76.0  91.0 122.  129.   75.9  92.7  74.6 100.   83.7
 3 114.   92.8 128.   94.8  70.2  85.9  96.3  82.7  62.1  72.9 122.  105.  103. 
 4  61.6 111.   66.1  88.2  57.5 102.   77.8  97.4  74.0 102.   79.1 112.  115. 
 5  46.2 131.   67.6 112.   42.6  82.8  87.3  71.3 101.   72.1  82.3  62.9  95.4
 6  74.6  94.4  52.3  97.1  86.3  72.0  83.6 109.   81.8  69.2  93.8 118.  109. 
 7  83.2 125.   74.8 103.   41.9 120.  124.  101.   41.6  82.8  80.7  77.8  93.2
 8  87.3 127.   61.1  86.8 102.  104.   93.7  86.1  58.6 126.   73.1  81.4 114. 
 9  87.9  91.3  81.8 136.   72.3 121.   83.6  99.6  96.4  96.5  65.6  95.8 107. 
10  56.4  93.9  96.5 111.   96.5  96.4 117.   93.9  71.8  51.3  60.3 104.   83.4
   `235` `236` `237` `238` `239` `240` `241` `242` `243` `244` `245` `246` `247`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  91.0  61.3 105.   68.0  83.3  80.6  86.5 109.   84.1  75.0  85.7  75.9  61.7
 2  79.3  80.6 126.   69.8  98.2  80.0 122.   83.9  44.9  95.7 101.   91.6  48.8
 3  64.1  92.2  90.8 125.   86.4  67.7 115.   78.0  83.5 106.   96.4  96.0  78.8
 4 109.   95.0  84.3  96.6  92.6  98.8  79.6  90.0 105.   66.8  55.5  77.0  57.3
 5  74.6  98.3  82.3  87.9  70.9 101.   98.1  70.7 102.   88.7  60.4  89.0  86.1
 6  65.4 121.   59.4  89.1 111.   98.1 105.   88.8  40.8  69.0  78.4  97.5 103. 
 7 116.   90.2  75.4 120.   68.2 145.   75.0 116.   82.1  84.5  90.0  68.7  71.8
 8  89.3  89.3  87.4 100.   69.1 111.  118.  133.   88.9  48.4 108.   40.7  77.4
 9 106.   97.0  89.9 142.   85.9  36.9 101.  118.   70.1 106.   72.8  81.0  69.5
10  76.7  87.7 131.   85.5  99.9  79.2 127.   83.1  92.6 112.   57.0  78.2  54.9
   `248` `249` `250` `251` `252` `253` `254` `255` `256` `257` `258` `259` `260`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  95.9 145.   68.8 107.   85.3  67.1  70.9  71.1 107.   76.8  51.1  56.8 108. 
 2  77.7  56.3 101.   84.6  78.7  92.6  85.5 114.   81.0  91.2  75.8  92.7  71.0
 3  80.3  94.1  55.7  93.8  75.8  78.7 102.   72.9  77.8 105.   75.2  53.4  78.5
 4  61.8  75.0  97.0 104.   65.8  85.0 104.   73.9 107.  101.   56.8  84.0  80.1
 5  53.6  60.7  85.6 107.   94.9 106.  112.  107.   75.8  88.9  29.4 103.   88.5
 6  89.5  89.2  83.6 112.   82.7 111.   89.8 103.   89.9 108.   82.4  78.5  56.6
 7  85.0  97.8  80.2  69.5 127.  101.   91.9  93.5  95.3 101.   86.2  76.7  94.6
 8  66.5  95.0  86.8 122.   86.0 114.  117.  106.  102.  132.   86.6  81.9 113. 
 9  94.3  72.3  87.9  96.0  99.1 117.  114.   52.2  85.5  96.1  76.9  93.1  91.5
10  91.2  53.5  95.2  88.7  79.1 102.  106.   72.6  83.2 112.   56.1  89.6  87.9
   `261` `262` `263` `264` `265` `266` `267` `268` `269` `270` `271` `272` `273`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 123.  108.  104.  110.   55.0  81.6  96.7  85.3  59.4  91.2  45.7  80.1  88.7
 2  77.5  60.5  82.8  62.4 115.   93.4  65.4  92.1  39.9 119.   54.3 109.  113. 
 3  77.7 109.  106.   74.3 106.  103.   71.9  47.1  27.2  69.5  61.9  90.1  88.0
 4  79.4 107.  120.   99.1  73.1 101.   85.3  78.5  83.0 105.   95.9 109.   72.1
 5  90.0 107.  104.   95.8 121.   91.3  66.7  71.2  38.4  68.0  39.3 109.  143. 
 6 117.   82.5  95.4 111.   88.5  90.0  84.6  73.1  27.0  59.9  60.8 102.   98.2
 7  74.5  63.3 110.   98.8  45.9 112.  116.   43.5 113.   90.7  98.1 102.   41.3
 8 103.  110.   92.0  55.5  61.3  75.2  70.4 102.   66.1  99.8  74.3  77.8  99.3
 9  80.0  76.8  99.1  46.9 107.   72.3  94.9  93.6  99.6  66.8 104.   95.7  83.5
10  91.1  90.1  99.4  70.8  83.6 121.   68.7  75.2  76.4 102.  121.   85.5 109. 
   `274` `275` `276` `277` `278` `279` `280` `281` `282` `283` `284` `285` `286`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  82.3  71.4  71.0  69.1  72.9  89.2 100.   71.6 120.  120.   46.9  65.4 105. 
 2  90.1  59.8  74.9  99.2  85.1  95.0  99.1 104.   65.6 111.  104.   51.6  58.1
 3 107.   74.7  85.4  64.2 105.   95.1  90.0  74.7  90.2 100.   89.3  84.0  68.0
 4  76.1  84.3  66.1  64.0  91.3 112.   44.8  66.8  96.8 109.   54.5 101.   80.8
 5 101.   92.9  69.4  75.3 112.  115.   94.0  61.0  90.7  96.6  71.6  94.2  30.4
 6  94.8  77.7  29.0  56.4 107.   54.2  95.6  97.3  65.3  76.0  75.4  40.5  75.3
 7 123.   59.9  53.2  60.6  69.6 102.   78.5  75.5  91.7 123.   92.9  82.1  84.6
 8  86.7 100.   97.3  65.9 122.   74.4  84.5  99.9  99.8 104.   81.7  64.8  60.0
 9 100.   82.3  71.2 110.  107.   75.1  88.5  86.4  94.1 100.   75.9  92.6  72.7
10  88.3  40.8  70.4  74.4  81.7 103.   55.6  79.4  83.1 112.   64.3  95.2  47.9
   `287` `288` `289` `290` `291` `292` `293` `294` `295` `296` `297` `298` `299`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.8  91.4  23.4  76.9  61.7 123.   47.8 103.   87.1  90.3  82.5  78.4 100. 
 2  62.0  79.0  88.9  79.3  68.8  82.8  63.4  75.7  63.8 123.   95.8  65.7  99.4
 3 106.   80.8  53.4  94.8  69.0  70.0  85.4  61.8  67.3  74.3  74.9  78.0  69.6
 4  66.8  96.9  91.3  92.4  88.8  70.5  73.1  99.0  45.3 114.   59.1  48.2  95.4
 5  99.4  64.2  73.7  83.1  82.2  66.8  64.1  99.2  94.1  82.8  93.6  70.5 106. 
 6  73.6  83.9  49.8  47.3  39.7 112.   74.9  93.0  87.3  49.0  86.6  44.1  62.1
 7  92.5  60.0  64.1  81.4  37.6  50.1  90.8  88.8  86.8  29.9  45.2  37.9  62.0
 8  92.9  64.0 130.  108.   38.7  84.1  48.1  72.3  75.1  89.9  59.1  82.3  59.0
 9  63.9  85.9  57.7  65.9  62.5  41.0  92.1  88.0  48.4  61.0  62.9  65.7  66.6
10  86.1  91.8  48.7  63.1  79.6  75.8  51.9  76.9  71.2  60.6 109.   62.7  69.5
   `300` `301` `302` `303` `304` `305` `306` `307` `308` `309` `310` `311` `312`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  83.7 115.   48.3 103.   72.3  65.8  87.7 108.   88.1  57.8  98.2  93.2 120. 
 2  88.8  49.3  86.9  80.5  80.7  77.9  75.0  94.4  63.5 116.   83.9  54.9 126. 
 3  68.0  68.6  40.6 107.   91.4  71.2 103.   97.5  92.6  88.5  85.7  77.4  82.3
 4  93.4  74.8  94.9  85.3  90.6  42.5  90.0  74.0 100.  113.   68.5 107.   78.8
 5  71.0  82.7 107.   85.5  52.5  91.0  89.0  86.9  80.7  98.7  71.8  74.9  98.2
 6  85.3  89.0  85.1  97.6 103.   61.0  95.0 104.  113.   88.2  65.1 107.   92.4
 7  95.7  76.0  84.3 108.   82.0  94.8  85.8 124.   78.5 109.   83.9  98.6 110. 
 8  60.7 106.   95.4  69.0  63.8  63.3  96.0 130.   68.9  45.3 104.   80.8  91.7
 9  84.4  95.4  81.1  81.3  65.5  74.4  75.6 111.  103.   94.3  74.7  73.8  94.4
10  76.3  89.9  72.3  93.5  63.6  66.9  92.4  81.4  87.6  90.5  70.9  94.6 129. 
   `313` `314` `315` `316` `317` `318` `319` `320` `321` `322` `323` `324` `325`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 116.  104.  113.  115.   80.6  88.0  97.7  92.4  86.8  86.5  87.1  55.3 108. 
 2 119.  104.   86.6 103.   88.4  53.7 102.   47.9  81.8  78.5 110.  100.  116. 
 3  85.1  70.7  85.9  99.2  60.4  71.2 114.   84.4  65.1  92.8  81.9 106.   73.1
 4  79.4  80.3  53.1  85.1  77.4  69.9  85.7  43.0  74.9  62.2  85.8  77.5  95.3
 5  49.7  90.4  81.0 105.   98.0  94.7 105.   77.8  51.7  83.6  88.9  77.6  76.9
 6  45.8  95.2 101.   95.5  84.3  97.6  92.2  72.2  84.8  98.8  56.7  87.8  90.6
 7  76.0  85.1  89.8  98.0  69.0  82.4  90.8  60.8  80.8  52.7  68.3  71.2  82.2
 8  76.7  64.9  85.1  80.7 102.   76.6  86.8  74.9  73.3  61.5 108.   64.0  89.9
 9 100.   93.8  94.0  77.3  90.2  95.4 114.  105.   53.7 115.  115.   68.9  96.2
10  88.6  97.7  87.4  94.7 103.   92.5  90.8  48.5 113.   66.2  64.1  89.3  73.1
   `326` `327` `328` `329` `330` `331` `332` `333` `334` `335` `336` `337` `338`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  80.4  87.8 136.  110.   76.0 115.   86.0  66.1 119.   89.6  78.3 107.  106. 
 2 115.  108.   98.4 109.   84.3  68.7  66.5  63.2 128.   81.0  99.9 122.   90.1
 3 105.   78.3  88.9  82.8 119.   79.8  59.5 125.  121.   76.8  84.5  67.1  54.5
 4  99.8  87.9  80.1  78.4  74.8  87.5  68.5  89.2 103.   42.6  96.6  69.7 103. 
 5 105.   63.4  92.7  84.1 114.   87.2  93.9 101.   95.1  75.5 103.   91.4  48.7
 6 115.   95.5  54.6 108.  102.  125.   93.8  70.3 106.   73.5 117.   60.5  59.2
 7  76.8  91.8  90.1 107.   88.9  87.6  69.6  93.4  89.1  89.2  62.3 105.  103. 
 8  93.6  77.7  90.6  50.5  97.1  77.7  58.8  49.3  96.0  57.7 103.  110.   91.5
 9 119.   54.5  90.2  93.7 102.   92.5  97.0  82.0 112.   73.8 135.  114.   70.2
10  84.7  59.7  95.4  77.6 125.   90.1  74.4  73.6  92.3  78.0  88.6  49.0  83.4
   `339` `340` `341` `342` `343` `344` `345` `346` `347` `348` `349` `350` `351`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  79.7  69.2  70.5 116.   63.9  95.1  91.6  36.2  72.5 103.  100.   83.4  84.4
 2  76.0  63.6  73.1 111.   73.1  63.4 121.   61.3  71.3 105.   94.6  90.6  94.2
 3  70.3  94.2  78.7  74.8  68.4  85.9  69.3 107.   97.5 135.   84.5  63.8  56.3
 4  48.8  99.4  79.9  62.7  80.7  42.0  71.0  77.0  54.1  92.6  87.5  84.1  82.1
 5  61.5  75.1  53.3 109.   87.9  79.2 104.   49.7  45.1  92.7  93.3  61.1  87.7
 6  50.4  76.6  63.3  49.8  62.4  91.7 102.   97.4 101.   91.7  69.3  68.5  94.2
 7  77.5  80.5  78.3  68.5  62.4 103.   87.0 113.   68.5  98.4  87.3  81.7  94.6
 8  99.0 109.   62.3  57.0  78.1  57.1  69.2  77.3  56.6  95.9  95.4  97.8  72.2
 9  85.2  56.4  66.0 109.   90.8  58.2  61.5  96.5 105.  128.   55.0  82.5 124. 
10  60.2  67.2  75.8  81.0  91.6  53.5  75.4  75.1  73.8  98.1  95.2  83.3  82.0
   `352` `353` `354` `355` `356` `357` `358` `359` `360` `361` `362` `363` `364`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 101.   94.8  73.9  67.0  67.2 110.   94.1  38.7 136.  110.  118.   47.6 106. 
 2  83.3  74.8  80.6  69.1  77.2  90.0  88.8 112.   63.1  60.4  65.9  89.6  85.9
 3  53.1  96.7  56.3  94.8  60.7 110.   89.5  88.6  90.0 110.   88.5  61.9 106. 
 4  83.0  69.8  77.1  97.3  66.8  77.5  70.1  79.7  96.9  75.9  84.8  86.2  72.9
 5  64.7  92.1 112.  120.   72.9  91.0  93.5  54.3  64.7  98.0  32.8  57.0  96.5
 6  68.5  93.8 104.  100.   72.9  94.3  80.1  84.9  89.1  83.4  81.4  96.9 105. 
 7 107.   80.9  83.6  79.6 102.   41.8 108.   73.5  85.4  75.0  97.3 100.  103. 
 8  86.9  83.9  78.2  59.1  88.1  87.4 100.  105.   58.6  74.9 100.   61.1 114. 
 9  78.6  52.7  62.5  93.8  52.7  45.1  76.3  92.2 120.   71.7  74.8  55.2  99.9
10 113.   87.7  98.1  51.1  83.0  91.9  81.8  75.3  91.3  95.1  90.5 105.   80.2
   `365` `366` `367` `368` `369` `370` `371` `372` `373` `374` `375` `376` `377`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  98.1 102.   71.6  88.2  72.4  77.4 131.   59.6  63.0  87.2  69.0  47.3  73.1
 2  66.2  92.9  96.4  58.1  96.9  80.5  78.9  98.5  91.9 104.   80.2  77.7 105. 
 3  58.4  92.7  67.3  79.4  92.3  70.3  74.5  85.9  68.9 109.   70.2  74.6  88.1
 4  75.4  48.1  60.5  81.0  96.6  95.2  71.5  58.2  97.1 110.   66.4  78.9  54.0
 5  79.4  76.0 113.   53.3  51.9  77.4  84.2  79.7  94.9 122.   75.0  80.3 101. 
 6  59.9  59.4  57.1  86.6  62.0  97.1 102.   80.1  46.1  83.0  63.1  72.7  90.5
 7  57.3 103.   85.1  94.4  74.1  60.8  75.3 116.   28.8  17.9  75.4  85.1  90.7
 8  41.1  79.3  95.6  73.6  95.4  65.1  89.8  70.5  73.4 103.   69.0  81.5  60.4
 9  64.8  91.6  75.9  95.4  81.1  66.3  68.1  93.6  75.1  78.8  75.0  97.8  79.3
10  78.1  86.3  98.9  77.7  65.2 101.   77.6  85.9  72.7 105.   90.7  92.9  96.5
   `378` `379` `380` `381` `382` `383` `384` `385` `386` `387` `388` `389` `390`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 110.   56.3  71.4 109.   75.5  60.3  85.0  45.9  76.9  77.7  72.2  90.2  89.8
 2 101.   90.0  52.0 121.   72.3  66.8  77.7  59.2 107.   87.3  87.8  51.0  78.6
 3  98.4  75.6  79.6 142.   53.4  69.3  86.5  72.3 110.  115.   81.3  57.8  85.3
 4  76.6  79.6 119.   60.5  53.6  83.6  55.1  75.5  73.1 100.   84.0  78.4  47.9
 5  68.9  73.3  88.6  92.1  63.7  66.7  84.8  59.5  86.3  73.7 107.   59.7  63.0
 6 112.   77.5  67.1  84.1  83.7  42.2  64.9  72.2  94.7  72.0  75.8  59.1  85.2
 7  57.5  83.6  60.8 104.   39.3  57.5  53.4  59.1  51.7  90.6 105.   69.7  59.3
 8  78.3 113.   98.0 109.   59.6  61.7  72.7  45.8  75.3  97.8  98.7  74.5  33.5
 9  91.8 126.   75.3  93.2  75.4  64.0  77.8 109.   56.2  97.6  76.8  31.6  90.8
10  99.4  95.5 105.   68.1  84.6  76.6  53.4  53.7  80.2 120.  106.   61.1  88.8
   `391` `392` `393` `394` `395` `396` `397` `398` `399` `400` `401` `402` `403`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  90.9 107.   72.4 127.   96.9  49.7  47.1  132. 113.  107.   68.6  60.8  82.3
 2  94.9  83.4 101.   94.1  84.5  26.7  76.6  108. 103.   60.9  81.1  80.9  86.1
 3  67.2 112.   53.7 102.   69.5  80.5  60.2  124.  98.7  90.0  93.8  44.7  94.3
 4  39.3 117.   57.7  78.0  67.4  77.2  86.9  109.  79.2  59.7  71.3  76.6  80.4
 5 121.  114.   80.0  90.5  89.2  67.3  83.9  107. 110.   76.9  84.3  81.8  99.8
 6  58.9  74.2  69.3 123.   82.5  83.6  78.0  123. 106.   91.1 117.   56.3  82.0
 7  86.8 105.   16.3  87.7  80.6 122.   60.3  143.  85.0  69.3 114.   45.2  62.7
 8  95.5  87.5  83.3 104.   64.9 138.   99.9  119. 104.   59.0  94.6  55.7  60.1
 9  87.7 110.   75.7  79.8  68.2  97.9  68.4  127.  61.6  97.5  80.5  91.9 102. 
10 108.   92.5  64.5 103.   68.3  46.1 110.   117. 103.   56.1  77.7 112.   81.0
   `404` `405` `406` `407` `408` `409` `410` `411` `412` `413` `414` `415` `416`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 128.   59.9  33.2  97.0  79.7 126.   90.9  91.0  93.7  90.3  76.8  99.9  71.1
 2  67.6  53.9  90.7  90.7 115.  106.   85.6  83.4  77.8  79.8  87.2  90.4  66.5
 3 135.   87.0  83.7 104.   71.1  87.2 106.   73.3  71.0 114.   97.7 112.   69.6
 4  87.8  64.9  66.2  87.6  75.7  88.3  66.7  96.5  75.5 111.  116.  112.   54.1
 5 119.   63.4 103.  116.   88.7 107.   83.1  88.9 104.  101.  103.  120.  114. 
 6 124.   78.0  64.3  98.5  75.5  94.1  80.9  81.2  87.3  76.2  95.4 104.  108. 
 7  70.4  50.2  96.8  87.1  97.1  97.2  90.1  92.1  74.9  55.6  86.0  92.0  76.7
 8 119.   25.6  55.1  92.2 115.   74.8  71.4  90.4 103.  101.   90.3 111.   60.6
 9 129.  112.   92.3  83.0 107.   95.5  59.0  56.4  76.8  69.0  69.3  70.0  98.1
10 129.   94.0  95.6  92.1  84.6  66.9  79.3  91.9  71.0  77.8 121.   88.7  69.7
   `417` `418` `419` `420` `421` `422` `423` `424` `425` `426` `427` `428` `429`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  54.2  85.1  75.4  49.8  99.2  60.8  77.8  80.0  87.1 133.  102.   65.5  47.6
 2  70.0  63.2  62.0  48.8  59.2  84.5  68.7 119.  114.  117.  113.   55.2  91.4
 3 109.   57.9  68.3  39.1  70.6  57.7 110.   97.7  80.8 121.  107.   55.1  74.6
 4  66.6  85.1 103.   63.6  83.9 108.   67.3  99.3  62.6 106.  119.   73.4  54.5
 5  89.0  60.6  72.9  67.6  60.7  61.5  79.0  93.4  71.2  91.7 105.   88.8  68.3
 6  85.5  71.0  54.5  96.5  66.0  92.8  93.4 130.   54.2 104.  127.   74.6  82.4
 7  91.6  66.9  80.9  88.1  78.0  84.6 112.  105.   46.5 116.  108.   76.2 106. 
 8  90.8  45.9  74.4  45.7  91.8  68.7  97.3 111.   67.7 121.  108.   78.1  53.4
 9  97.1  78.7  79.5  84.3  80.4  77.5  90.0 103.   49.9  59.0  82.0  65.7 116. 
10  98.1  72.7 105.   57.0  85.0  66.2  77.7  97.8  69.8 110.  115.   41.8  58.4
   `430` `431` `432` `433` `434`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  70.1 111.  124.   93.6  82.9
 2  35.4 116.   79.5  88.1  86.4
 3  72.3 129.   90.6  73.9  87.8
 4  89.6  57.3  77.9  79.8  78.2
 5  67.3  88.1 109.   96.5  88.7
 6  37.1  53.7  64.4 104.  115. 
 7  77.1  91.2  59.0  83.6  78.4
 8  50.3  90.5  82.1  68.3  90.1
 9  92.4  91.3  68.4  74.1  61.6
10  67.6  97.1  79.2  79.5  71.1
# â„¹ 3,990 more rows</code></pre>
</div>
</div>
<p>The advantage of <code>posterior_predict()</code> over <code>posterior_linpred()</code> is that we can generate predictions for new data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>predict_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mom_iq =</span> <span class="dv">110</span>,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mom_hs =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>predict_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 2
  mom_iq mom_hs
   &lt;dbl&gt;  &lt;dbl&gt;
1    110      0
2    110      1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>new_predictions <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(model_2pred, <span class="at">newdata =</span> predict_data)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>new_predictions <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,000 Ã— 2
     `1`   `2`
   &lt;dbl&gt; &lt;dbl&gt;
 1 112.   63.2
 2  83.2  93.9
 3 104.  118. 
 4 108.  107. 
 5  88.9  65.7
 6  58.2  63.8
 7 119.  110. 
 8  58.2  99.5
 9  73.6  80.9
10  85.2 107. 
# â„¹ 3,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_predictions[, <span class="dv">1</span>]) <span class="co"># No HS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   27.7    76.0    87.9    88.0   100.1   150.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_predictions[, <span class="dv">2</span>]) <span class="co"># Completed HS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   22.2    81.8    93.6    93.8   106.0   155.6 </code></pre>
</div>
</div>
</section>
<section id="visualizing-predictions" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-predictions">Visualizing predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>new_predictions <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(new_predictions) <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"No HS"</span>, <span class="st">"Completed HS"</span>))</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>plot_new_predictions <span class="ot">&lt;-</span> new_predictions <span class="sc">|&gt;</span> <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"HS"</span>, <span class="at">value =</span> <span class="st">"predict"</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>plot_new_predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,000 Ã— 2
   HS    predict
   &lt;chr&gt;   &lt;dbl&gt;
 1 No HS   112. 
 2 No HS    83.2
 3 No HS   104. 
 4 No HS   108. 
 5 No HS    88.9
 6 No HS    58.2
 7 No HS   119. 
 8 No HS    58.2
 9 No HS    73.6
10 No HS    85.2
# â„¹ 7,990 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_density</span>(<span class="sc">~</span> predict, <span class="at">data =</span> plot_new_predictions) <span class="sc">|&gt;</span> <span class="fu">gf_facet_wrap</span>(<span class="sc">~</span> HS, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="datacamp_rstanarm_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>