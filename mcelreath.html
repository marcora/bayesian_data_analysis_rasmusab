<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical rethinking (mcelreath)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="mcelreath_files/libs/clipboard/clipboard.min.js"></script>
<script src="mcelreath_files/libs/quarto-html/quarto.js"></script>
<script src="mcelreath_files/libs/quarto-html/popper.min.js"></script>
<script src="mcelreath_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mcelreath_files/libs/quarto-html/anchor.min.js"></script>
<link href="mcelreath_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mcelreath_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mcelreath_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mcelreath_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mcelreath_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical rethinking (mcelreath)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="https://github.com/rmcelreath/stat_rethinking_2023" class="uri">https://github.com/rmcelreath/stat_rethinking_2023</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(triangle)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2020</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inference = a conclusion reached on the basis of evidence and reasoning.</p>
<p>Reasoning = thinking about something in a logical, sensible way.</p>
<p>“Researchers are entrusted with drawing inferences from the data”.</p>
<p>Learning how to perform statistical inference is like learning to write a novel in a foreign language (statistics and probability theory).</p>
<section id="the-cycle-of-science" class="level2">
<h2 class="anchored" data-anchor-id="the-cycle-of-science">The cycle of science</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://bebi103a.github.io/lessons/01/cycle_of_science.html"><img src="images/image-13316612.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="https://bebi103a.github.io/lessons/01/cycle_of_science.html" class="uri">https://bebi103a.github.io/lessons/01/cycle_of_science.html</a></p>
</section>
<section id="data-analysis-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis-pipeline">Data analysis pipeline</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://bebi103a.github.io/lessons/01/cycle_of_science.html"><img src="images/image-2023841330.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="https://bebi103a.github.io/lessons/01/cycle_of_science.html" class="uri">https://bebi103a.github.io/lessons/01/cycle_of_science.html</a></p>
</section>
<section id="bayes-ruletheorem" class="level2">
<h2 class="anchored" data-anchor-id="bayes-ruletheorem">Bayes’ rule/theorem</h2>
<p><span class="math display">\[
P(A,B) = P(A \mid B) P(B)
\]</span></p>
<p><span class="math display">\[
P(B,A) = P(B \mid A) P(A)
\]</span></p>
<p><span class="math display">\[
P(A,B) = P(B,A)
\]</span></p>
<p><span class="math display">\[
P(A \mid B) P(B) = P(A,B) = P(B,A) = P(B \mid A) P(A)
\]</span></p>
<p><span class="math display">\[
P(A \mid B) = \frac{P(B \mid A) P(A)}{P(B)}
\]</span></p>
<p><span class="math display">\[
P(H \mid D) = \frac{P(D \mid H) P(H)}{P(D)}
\]</span></p>
<p>Bayes’ rule holds for PDFs as it does for probabilities:</p>
<p><span class="math display">\[
p(\theta \mid y) = \frac{p(y \mid \theta) p(\theta)}{p(y)}
\]</span> <span class="math display">\[
p(\theta \mid y) = \frac{p(y \mid \theta) p(\theta)}{\int_\theta p(y \mid \theta) p(\theta) d\theta}
\]</span></p>
<p><span class="math display">\[
p(\theta \mid y) \propto p(y \mid \theta) p(\theta) = p(y, \theta)
\]</span></p>
<p><span class="math display">\[
\text{posterior} \propto \text{likelihood} \times \text{prior}
\]</span></p>
</section>
<section id="frequentist-vs-bayesian" class="level2">
<h2 class="anchored" data-anchor-id="frequentist-vs-bayesian">Frequentist vs Bayesian</h2>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th>Frequentist</th>
<th>Bayesian</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Probability is “long-run relative frequency”</td>
<td>Probability is “degree of certainty/relative plausability”</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P(X \mid \theta)\)</span> is a sampling distribution<br>
(function of <span class="math inline">\(X\)</span> with <span class="math inline">\(\theta\)</span> fixed)</td>
<td><span class="math inline">\(P(X \mid \theta)\)</span> is a likelihood function<br>
(function of <span class="math inline">\(\theta\)</span> with <span class="math inline">\(X\)</span> fixed)</td>
</tr>
<tr class="odd">
<td>No prior</td>
<td>Prior</td>
</tr>
<tr class="even">
<td>P-values (NHST)</td>
<td>Full posterior distribution available for summary/decisions</td>
</tr>
<tr class="odd">
<td>Confidence intervals</td>
<td>Credible intervals</td>
</tr>
<tr class="even">
<td><p>Violates the “likelihood principle”:</p>
<ul>
<li>Sampling intention matters</li>
<li>Correction for multiple testing</li>
<li>Adjustment for planned/post-hoc testing</li>
</ul></td>
<td><p>Respects the “likelihood principle”:</p>
<ul>
<li>Sampling intention does not matter</li>
<li>No correction for multiple testing</li>
<li>No adjustment for planned/post-hoc testing</li>
</ul></td>
</tr>
<tr class="odd">
<td>Objective?</td>
<td>Subjective?</td>
</tr>
</tbody>
</table>
</section>
<section id="bayesian-inference-worfklow" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-inference-worfklow">Bayesian inference worfklow</h2>
<ol type="1">
<li><p>Question/goal [<strong>estimand</strong>]</p></li>
<li><p>Scientific model (of the data generation process, aka generative model)</p></li>
<li><p>Statistical model(s) [<strong>estimator</strong>]</p></li>
<li><p>Validate model</p></li>
<li><p>Analyze data [<strong>estimate</strong>]</p></li>
</ol>
<p>An <strong>estimator</strong> is a rule for calculating an <strong>estimate</strong> of a quantity of interest (the <strong>estimand</strong>) based on observed data: thus the rule (the estimator), the quantity of interest (the estimand) and its result (the estimate) are distinguished. For example, the sample mean is a commonly used estimator of the population mean (the estimand).</p>
<p>When we take measurements, we are observing samples out of an underlying, typically unknown, <strong>generative distribution</strong>. If we have a full understanding of the generative distribution, we have learned how the data were generated, and thereby have an understanding of the physical, chemical, or biological phenomena we are studying. <strong>Statistical inference</strong> involves deducing properties of these (unknown) generative distributions.</p>
</section>
<section id="why-models" class="level2">
<h2 class="anchored" data-anchor-id="why-models">Why models?</h2>
<p>As scientists, our goal is to learn about how nature works. We can make observations and measurements, and these are usually in the service of gaining an understanding of how nature works. In their book Physical Biology of the Cell, Phillips, et al.&nbsp;write that:</p>
<blockquote class="blockquote">
<p>…quantitative data demand quantitative models and, conversely, …quantitative models need to provide experimentally testable quantitative predictions about biological phenomena.</p>
</blockquote>
<p>It is in this spirit that we approach parametric inference. Our goal is to model the process of data generation, and using the measured data to learn about the model. This leads to knowledge.</p>
</section>
<section id="binomial-estimation" class="level2">
<h2 class="anchored" data-anchor-id="binomial-estimation">Binomial estimation</h2>
<section id="questiongoalestimand" class="level3">
<h3 class="anchored" data-anchor-id="questiongoalestimand">Question/goal/estimand</h3>
<p>Globe tossing example. Estimate proportion of globe surface covered by water.</p>
</section>
<section id="scientific-model" class="level3">
<h3 class="anchored" data-anchor-id="scientific-model">Scientific model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdag</span>(<span class="fu">dagify</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  WL <span class="sc">~</span> p,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">"p"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"WL"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">WL =</span> <span class="st">"Fuck"</span>, <span class="at">p =</span> <span class="st">"pi"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span> <span class="fu">theme_dag_blank</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mcelreath_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><span class="math inline">\(W,L = f(\pi)\)</span></p>
</section>
<section id="statistical-model" class="level3">
<h3 class="anchored" data-anchor-id="statistical-model">Statistical model</h3>
<p>Observations (data) and explanations (parameters) are variables.</p>
<p>Observed/known variables are data, unobserved/unknown variables are parameters.</p>
<p>[known/unknown constants]</p>
<p>For each variable, must say how it is generated.</p>
<p>List variables as deterministic or stochastic/distributional functions:</p>
<p><span class="math display">\[
W=3,L=6 \sim \text{Binomial}(\pi)
\]</span></p>
<p><span class="math display">\[
\pi \sim \text{Uniform}(a=0, b=1)
\]</span></p>
<p>Stochastic/distributional functions can also be expressed as probability statements:</p>
<p>[Data distribution/Likelihood function]</p>
<p><span class="math display">\[
P(W = 3,L = 6 \mid \pi) =  \text{Binomial}(W = 3, L = 6, \pi) = \frac{(W+L)!}{W!L!} \pi^W (1 - \pi)^L = \\ \frac{(3+6)!}{3!6!} \pi^3 (1 - \pi)^6 = \frac{362880}{4320} \pi^3 (1 - \pi)^6  = 84 \pi^3 (1 - \pi)^6
\]</span></p>
<p>[Prior distribution]</p>
<p><span class="math display">\[
P(\pi \mid a=0,b=1) = \text{Uniform}(\pi, a=0, b=1) = \frac{1}{b - a} \\ = \frac{1}{1 - 0} = 1
\]</span></p>
<p>Bayesian estimator (posterior <span class="math inline">\(\propto\)</span> likelihood <span class="math inline">\(\times\)</span> prior):</p>
<p><span class="math display">\[
P(\pi \mid W = 3, L = 6) \propto \text{Binomial}(W = 3, L = 6, \pi) \times \text{Uniform}(\pi, a = 0, b = 1)
\]</span></p>
<p><span class="math display">\[
P(\pi \mid W = 3, L = 6) \propto 84 \pi^3 (1 - \pi)^6 \times 1
\]</span></p>
<p><span class="math display">\[
P(\pi \mid W = 3, L = 6) \propto \pi^3 (1 - \pi)^6
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>WL <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"W"</span>, <span class="st">"W"</span>, <span class="st">"L"</span>, <span class="st">"L"</span>, <span class="st">"L"</span>, <span class="st">"L"</span>, <span class="st">"W"</span>, <span class="st">"L"</span>, <span class="st">"L"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">sum</span>(WL <span class="sc">==</span> <span class="st">"W"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">sum</span>(WL <span class="sc">==</span> <span class="st">"L"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#W = 10</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#L = 20</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">len =</span> <span class="dv">1000</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>binomial <span class="ot">&lt;-</span> <span class="cf">function</span>(W, L, p) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(W <span class="sc">+</span> L)<span class="sc">/</span>(<span class="fu">factorial</span>(W)<span class="sc">*</span><span class="fu">factorial</span>(L)) <span class="sc">*</span> p<span class="sc">^</span>W <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>L)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>uniform <span class="ot">&lt;-</span> <span class="cf">function</span>(p, a, b) {</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(b <span class="sc">-</span> a))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">=</span> <span class="fu">binomial</span>(W, L, p)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">=</span> <span class="fu">uniform</span>(p, a, b)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#likelihood = dbinom(W, W+L, p)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#prior = dunif(p, a, b)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">=</span> likelihood <span class="sc">*</span> prior <span class="sc">/</span> <span class="fu">sum</span>(likelihood)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posterior <span class="sc">~</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mcelreath_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="validate-model" class="level3">
<h3 class="anchored" data-anchor-id="validate-model">Validate model</h3>
</section>
<section id="analyze-data" class="level3">
<h3 class="anchored" data-anchor-id="analyze-data">Analyze data</h3>
</section>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear regression</h2>
<ol type="1">
<li><p>Question/goal [estimand]: State a clear <strong>question</strong> (inferential or descriptive)</p>
<ul>
<li>Describe association between (adult) weight and height</li>
</ul></li>
<li><p>Scientific model: Sketch the causal <strong>assumptions</strong> (DAG)</p>
<ul>
<li><p>Height → Weight ← [Unobserved]</p></li>
<li><p>Weight is some function of height [and other unobserved variables/influences] <span class="math inline">\(W = f(H,U)\)</span></p></li>
</ul></li>
<li><p>Statistical model: Use the sketch to define a <strong>generative model</strong></p>
<ul>
<li><p>What is this function <span class="math inline">\(f\)</span> ?</p></li>
<li><p>How does height influences weight?</p></li>
<li><p>For example, a linear function: <span class="math inline">\(W = \alpha + \beta H + U\)</span></p></li>
<li><p>It should be able to generate realistic data!</p></li>
</ul></li>
<li><p>Statistical model: Use the generative model to build an <strong>estimator</strong></p>
<ul>
<li><p>We want to estimate how the average weight changes with height.</p></li>
<li><p>How does average weight changes with height?</p></li>
<li><p><span class="math inline">\(E(W_i \mid H_i) = \alpha + \beta H_i\)</span></p></li>
<li><p>In Bayesian inference the estimator is always the posterior distribution.</p></li>
<li><p><span class="math inline">\(P(\alpha, \beta, \sigma \mid H_i, W_i) = \frac{P(W_i \mid H_i, \alpha, \beta, \sigma) P(\alpha, \beta, \sigma)}{Z}\)</span></p></li>
<li><p>In conventional statistical model notation:</p>
<p><span class="math display">\[
W_i \sim \text{Normal}(\mu_i, \sigma) \\
\mu_i = \alpha + \beta H_i \\
\alpha \sim \text{Normal}(0, 10) \\
\beta \sim \text{Uniform}(0, 1) \\
\sigma \sim \text{Uniform}(0, 10) \\
\]</span></p>
<p><span class="math inline">\(W\)</span> is distributed normally with mean that is a linear function of <span class="math inline">\(H\)</span>.</p></li>
<li><p>Prior predictive distribution.</p></li>
</ul></li>
<li><p>Validate statistical model</p>
<ul>
<li>Analyze data simulated using the generative model.</li>
</ul></li>
<li><p>Use the statistical model to analyze data/calculate estimate</p>
<ul>
<li><p>Estimate = Posterior distribution.</p></li>
<li><p>Posterior predictive distribution.</p></li>
</ul></li>
</ol>
<p>An <strong>estimator</strong> is a rule for calculating an <strong>estimate</strong> of a quantity of interest (the <strong>estimand</strong>) based on observed data: thus the rule (the estimator), the quantity of interest (the estimand) and its result (the estimate) are distinguished. For example, the sample mean is a commonly used estimator of the population mean (the estimand).</p>
<section id="generative-model" class="level3">
<h3 class="anchored" data-anchor-id="generative-model">Generative model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sim_weight <span class="ot">&lt;-</span> <span class="cf">function</span>(H, beta, sd) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(H), <span class="dv">0</span>, sd)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">=</span> beta <span class="sc">*</span> H <span class="sc">+</span> U</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>H <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">130</span>, <span class="at">max =</span> <span class="dv">170</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">sim_weight</span>(H, <span class="at">beta =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(W <span class="sc">~</span> H, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mcelreath_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conventional-statistical-model-notation" class="level3">
<h3 class="anchored" data-anchor-id="conventional-statistical-model-notation">Conventional statistical model notation</h3>
<ol type="1">
<li><p>List the variables</p></li>
<li><p>Define each variable as a deterministic or distributional/stochastic function of the other variables</p></li>
</ol>
<p><span class="math display">\[
W_i = \beta H_i + U_i \\
U_i \sim \text{Normal}(0, \sigma) \\
H_i \sim \text{Uniform}(130, 170)
\]</span></p>
<p>Variables on the left, functions on the right (equal sign for deterministic functions, tilde sign for distributional/stochastic functions).</p>
</section>
<section id="prior-predictive-distribution" class="level3">
<h3 class="anchored" data-anchor-id="prior-predictive-distribution">Prior predictive distribution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">130</span>, <span class="dv">170</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">95</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"height (cm)"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"weight (kg)"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) <span class="fu">abline</span>(<span class="at">a =</span> a[j], <span class="at">b =</span> b[j], <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="mcelreath_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>H <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">130</span>, <span class="at">max =</span> <span class="dv">170</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">sim_weight</span>(H, <span class="at">beta =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>m3<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">quap</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    W <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> H,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">data =</span> <span class="fu">tibble</span>(W, H))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m3<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         mean      sd     5.5%  94.5%
a     -3.6113 8.37377 -16.9942 9.7716
b      0.5213 0.05564   0.4324 0.6102
sigma  4.4520 1.00455   2.8465 6.0574</code></pre>
</div>
</div>
</section>
</section>
<section id="lost-and-found" class="level2">
<h2 class="anchored" data-anchor-id="lost-and-found">Lost and found</h2>
<p>In frequentist inference, parameters are considered to be fixed/constants but unknown.</p>
<p>In Bayesian inference, parameters are considered to be random variables instead of constants.</p>
<p>Non-parametric (vs parametric) inference is statistical inference where no model is assumed; conclusions are drawn from the data alone.</p>
<p>The <strong>bias</strong> of an estimate is the difference between the expected value of the point estimate and the value of the parameter. The bias is typically small. Biased and unbiased estimators of the variance differ by a factor of <span class="math inline">\(n/(n−1)\)</span>, which is negligible when <span class="math inline">\(n\)</span> is large.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>